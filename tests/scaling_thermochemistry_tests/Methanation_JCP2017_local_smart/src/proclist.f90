!  This file was generated by kmcos (kinetic Monte Carlo of Systems)
!  written by Max J. Hoffmann mjhoffmann@gmail.com (C) 2009-2013.
!  The model was written by Mie Andersen.

!  This file is part of kmcos.
!
!  kmcos is free software; you can redistribute it and/or modify
!  it under the terms of the GNU General Public License as published by
!  the Free Software Foundation; either version 2 of the License, or
!  (at your option) any later version.
!
!  kmcos is distributed in the hope that it will be useful,
!  but WITHOUT ANY WARRANTY; without even the implied warranty of
!  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
!  GNU General Public License for more details.
!
!  You should have received a copy of the GNU General Public License
!  along with kmcos; if not, write to the Free Software
!  Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301
!  USA
!****h* kmcos/proclist
! FUNCTION
!    Implements the kMC process list.
!
!******


module proclist
use kind_values
use base, only: &
    update_accum_rate, &
    update_integ_rate, &
    update_integ_counter, &
    update_integ_rate_sb, &
    determine_procsite, &
    update_clocks, &
    avail_sites, &
    null_species, &
    increment_procstat, &
    update_eq_proc, &
    check_proc_eq, &
    unscale_reactions, &
    scale_reactions, &
    update_sum_sf, &
    get_save_limit, &
    save_execution, &
    reset_saved_execution_data

use lattice, only: &
    Rh211, &
    Rh211_s, &
    Rh211_t, &
    Rh211_f, &
    allocate_system, &
    nr2lattice, &
    lattice2nr, &
    add_proc, &
    can_do, &
    set_rate_const, &
    replace_species, &
    del_proc, &
    reset_site, &
    system_size, &
    spuck, &
    get_species


implicit none



 ! Species constants



integer(kind=iint), parameter, public :: nr_of_species = 8
integer(kind=iint), parameter, public :: C = 0
integer(kind=iint), parameter, public :: CH = 1
integer(kind=iint), parameter, public :: CH2 = 2
integer(kind=iint), parameter, public :: CH3 = 3
integer(kind=iint), parameter, public :: CO = 4
integer(kind=iint), parameter, public :: O = 5
integer(kind=iint), parameter, public :: OH = 6
integer(kind=iint), parameter, public :: empty = 7
integer(kind=iint), public :: default_species = empty


! Process constants

integer(kind=iint), parameter, public :: CH2_diff_s_N_s = 1
integer(kind=iint), parameter, public :: CH2_diff_s_s_N = 2
integer(kind=iint), parameter, public :: CH2_diff_s_t = 3
integer(kind=iint), parameter, public :: CH2_diff_s_t_N = 4
integer(kind=iint), parameter, public :: CH2_diff_t_N_s = 5
integer(kind=iint), parameter, public :: CH2_diff_t_S_t = 6
integer(kind=iint), parameter, public :: CH2_diff_t_s = 7
integer(kind=iint), parameter, public :: CH2_diff_t_t_S = 8
integer(kind=iint), parameter, public :: CH2_s_E_dis_f = 9
integer(kind=iint), parameter, public :: CH2_s_dis = 10
integer(kind=iint), parameter, public :: CH2_t_N_dis_f = 11
integer(kind=iint), parameter, public :: CH2_t_dis = 12
integer(kind=iint), parameter, public :: CH2_t_dis_f = 13
integer(kind=iint), parameter, public :: CH3_diff_s_N_s = 14
integer(kind=iint), parameter, public :: CH3_diff_s_s_N = 15
integer(kind=iint), parameter, public :: CH3_diff_s_t = 16
integer(kind=iint), parameter, public :: CH3_diff_s_t_N = 17
integer(kind=iint), parameter, public :: CH3_diff_t_N_s = 18
integer(kind=iint), parameter, public :: CH3_diff_t_S_t = 19
integer(kind=iint), parameter, public :: CH3_diff_t_s = 20
integer(kind=iint), parameter, public :: CH3_diff_t_t_S = 21
integer(kind=iint), parameter, public :: CH3_s_dis = 22
integer(kind=iint), parameter, public :: CH3_t_dis = 23
integer(kind=iint), parameter, public :: CH4_s_ads = 24
integer(kind=iint), parameter, public :: CH4_t_ads = 25
integer(kind=iint), parameter, public :: CH_diff_f_S_f = 26
integer(kind=iint), parameter, public :: CH_diff_f_f_S = 27
integer(kind=iint), parameter, public :: CH_diff_f_s_E = 28
integer(kind=iint), parameter, public :: CH_diff_f_t = 29
integer(kind=iint), parameter, public :: CH_diff_f_t_N = 30
integer(kind=iint), parameter, public :: CH_diff_s_E_f = 31
integer(kind=iint), parameter, public :: CH_diff_s_N_s = 32
integer(kind=iint), parameter, public :: CH_diff_s_s_N = 33
integer(kind=iint), parameter, public :: CH_diff_s_t = 34
integer(kind=iint), parameter, public :: CH_diff_s_t_N = 35
integer(kind=iint), parameter, public :: CH_diff_t_N_f = 36
integer(kind=iint), parameter, public :: CH_diff_t_N_s = 37
integer(kind=iint), parameter, public :: CH_diff_t_S_t = 38
integer(kind=iint), parameter, public :: CH_diff_t_f = 39
integer(kind=iint), parameter, public :: CH_diff_t_s = 40
integer(kind=iint), parameter, public :: CH_diff_t_t_S = 41
integer(kind=iint), parameter, public :: CH_f_dis = 42
integer(kind=iint), parameter, public :: CH_s_dis = 43
integer(kind=iint), parameter, public :: CH_t_dis = 44
integer(kind=iint), parameter, public :: CO_ads_s = 45
integer(kind=iint), parameter, public :: CO_ads_t = 46
integer(kind=iint), parameter, public :: CO_des_s = 47
integer(kind=iint), parameter, public :: CO_des_t = 48
integer(kind=iint), parameter, public :: CO_diff_s_N_s = 49
integer(kind=iint), parameter, public :: CO_diff_s_s_N = 50
integer(kind=iint), parameter, public :: CO_diff_s_t = 51
integer(kind=iint), parameter, public :: CO_diff_s_t_N = 52
integer(kind=iint), parameter, public :: CO_diff_t_N_s = 53
integer(kind=iint), parameter, public :: CO_diff_t_S_t = 54
integer(kind=iint), parameter, public :: CO_diff_t_s = 55
integer(kind=iint), parameter, public :: CO_diff_t_t_S = 56
integer(kind=iint), parameter, public :: C_OH_s_react_t_NW = 57
integer(kind=iint), parameter, public :: C_OH_s_react_t_W = 58
integer(kind=iint), parameter, public :: C_OH_t_react_f = 59
integer(kind=iint), parameter, public :: C_OH_t_react_f_S = 60
integer(kind=iint), parameter, public :: C_diff_f_S_f = 61
integer(kind=iint), parameter, public :: C_diff_f_f_S = 62
integer(kind=iint), parameter, public :: C_diff_f_s_E = 63
integer(kind=iint), parameter, public :: C_diff_f_t = 64
integer(kind=iint), parameter, public :: C_diff_f_t_N = 65
integer(kind=iint), parameter, public :: C_diff_s_E_f = 66
integer(kind=iint), parameter, public :: C_diff_s_N_s = 67
integer(kind=iint), parameter, public :: C_diff_s_s_N = 68
integer(kind=iint), parameter, public :: C_diff_s_t = 69
integer(kind=iint), parameter, public :: C_diff_s_t_N = 70
integer(kind=iint), parameter, public :: C_diff_t_N_f = 71
integer(kind=iint), parameter, public :: C_diff_t_N_s = 72
integer(kind=iint), parameter, public :: C_diff_t_S_t = 73
integer(kind=iint), parameter, public :: C_diff_t_f = 74
integer(kind=iint), parameter, public :: C_diff_t_s = 75
integer(kind=iint), parameter, public :: C_diff_t_t_S = 76
integer(kind=iint), parameter, public :: H2O_O_s_react_s_N = 77
integer(kind=iint), parameter, public :: H2O_O_s_react_s_S = 78
integer(kind=iint), parameter, public :: H2O_O_s_react_t = 79
integer(kind=iint), parameter, public :: H2O_O_s_react_t_N = 80
integer(kind=iint), parameter, public :: H2O_O_t_N_react_s = 81
integer(kind=iint), parameter, public :: H2O_O_t_react_s = 82
integer(kind=iint), parameter, public :: H2O_O_t_react_t_N = 83
integer(kind=iint), parameter, public :: H2O_O_t_react_t_S = 84
integer(kind=iint), parameter, public :: H2O_s_ads = 85
integer(kind=iint), parameter, public :: H2O_t_ads = 86
integer(kind=iint), parameter, public :: H_CH2_s_react = 87
integer(kind=iint), parameter, public :: H_CH2_t_react = 88
integer(kind=iint), parameter, public :: H_CH3_s_react = 89
integer(kind=iint), parameter, public :: H_CH3_t_react = 90
integer(kind=iint), parameter, public :: H_CH_f_react_s_E = 91
integer(kind=iint), parameter, public :: H_CH_f_react_t = 92
integer(kind=iint), parameter, public :: H_CH_f_react_t_N = 93
integer(kind=iint), parameter, public :: H_CH_s_react = 94
integer(kind=iint), parameter, public :: H_CH_t_react = 95
integer(kind=iint), parameter, public :: H_CO_s_react_t_NW = 96
integer(kind=iint), parameter, public :: H_CO_s_react_t_W = 97
integer(kind=iint), parameter, public :: H_CO_t_react_f = 98
integer(kind=iint), parameter, public :: H_CO_t_react_f_S = 99
integer(kind=iint), parameter, public :: H_C_f_react = 100
integer(kind=iint), parameter, public :: H_C_s_react = 101
integer(kind=iint), parameter, public :: H_C_t_react = 102
integer(kind=iint), parameter, public :: H_OH_s_react = 103
integer(kind=iint), parameter, public :: H_OH_t_react = 104
integer(kind=iint), parameter, public :: H_O_s_react = 105
integer(kind=iint), parameter, public :: H_O_t_react = 106
integer(kind=iint), parameter, public :: OH_OH_s_react_s_N = 107
integer(kind=iint), parameter, public :: OH_OH_s_react_s_S = 108
integer(kind=iint), parameter, public :: OH_OH_s_react_t = 109
integer(kind=iint), parameter, public :: OH_OH_s_react_t_N = 110
integer(kind=iint), parameter, public :: OH_OH_t_N_react_s = 111
integer(kind=iint), parameter, public :: OH_OH_t_react_s = 112
integer(kind=iint), parameter, public :: OH_OH_t_react_t_N = 113
integer(kind=iint), parameter, public :: OH_OH_t_react_t_S = 114
integer(kind=iint), parameter, public :: OH_diff_s_N_s = 115
integer(kind=iint), parameter, public :: OH_diff_s_s_N = 116
integer(kind=iint), parameter, public :: OH_diff_s_t = 117
integer(kind=iint), parameter, public :: OH_diff_s_t_N = 118
integer(kind=iint), parameter, public :: OH_diff_t_N_s = 119
integer(kind=iint), parameter, public :: OH_diff_t_S_t = 120
integer(kind=iint), parameter, public :: OH_diff_t_s = 121
integer(kind=iint), parameter, public :: OH_diff_t_t_S = 122
integer(kind=iint), parameter, public :: OH_s_dis = 123
integer(kind=iint), parameter, public :: OH_t_dis = 124
integer(kind=iint), parameter, public :: O_diff_s_N_s = 125
integer(kind=iint), parameter, public :: O_diff_s_s_N = 126
integer(kind=iint), parameter, public :: O_diff_s_t = 127
integer(kind=iint), parameter, public :: O_diff_s_t_N = 128
integer(kind=iint), parameter, public :: O_diff_t_N_s = 129
integer(kind=iint), parameter, public :: O_diff_t_S_t = 130
integer(kind=iint), parameter, public :: O_diff_t_s = 131
integer(kind=iint), parameter, public :: O_diff_t_t_S = 132


integer(kind=iint), parameter, public :: representation_length = 65
integer(kind=iint), public :: seed_size = 33
integer(kind=iint), public :: seed ! random seed
integer(kind=iint), public, dimension(:), allocatable :: seed_arr ! random seed


integer(kind=iint), parameter, public :: nr_of_proc = 132

integer(kind=iint), public :: counter_sp
integer(kind=iint), public :: counter_ini
integer(kind=ishort), public :: debug


contains

subroutine set_debug_level(debug_level)
    integer(kind=ishort), intent(in) :: debug_level
    debug = debug_level
end subroutine set_debug_level

subroutine do_kmc_steps(n)

!****f* proclist/do_kmc_steps
! FUNCTION
!    Performs ``n`` kMC step.
!    If one has to run many steps without evaluation
!    do_kmc_steps might perform a little better.
!    * first update clock
!    * then configuration sampling step
!    * last execute process
!
! ARGUMENTS
!
!    ``n`` : Number of steps to run
!******
    integer(kind=ilong), intent(in) :: n

    integer(kind=ilong) :: i
    real(kind=rsingle) :: ran_proc, ran_time, ran_site
    integer(kind=iint) :: nr_site, proc_nr

    do i = 1, n
    call random_number(ran_time)
    call random_number(ran_proc)
    call random_number(ran_site)
    call update_accum_rate
    call update_clocks(ran_time)

    call update_integ_rate
    call update_integ_counter
    call determine_procsite(ran_proc, ran_site, proc_nr, nr_site)
    call run_proc_nr(proc_nr, nr_site)
    enddo

end subroutine do_kmc_steps

subroutine do_acc_kmc_steps(n, sampling_steps, stats, save_exe, save_proc)

!****f* proclist/do_acc_kmc_steps
! FUNCTION
!    Performs ``n`` kMC step in accelerated mode.
!    * first update clock
!    * then configuration sampling step
!    * then execute process
!    * last do checks in acc. scheme
!    * if stats is True, calculate statistics
!
! ARGUMENTS
!
!    ``n`` : Number of steps to run
!    ``sampling_steps`` : Number of steps in sampling period.
!    ``stats`` : Logical, if True statistics will be calculated
!    ``save_exe`` : Logical, if True the executions following the
!    the process save_proc will be saved.
!******
    integer(kind=ilong), intent(in) :: n
    integer(kind=iint), intent(in) :: sampling_steps, save_proc
    logical, intent(in) :: stats, save_exe

    integer(kind=ilong) :: i
    real(kind=rsingle) :: ran_proc, ran_time, ran_site
    integer(kind=iint) :: nr_site, proc_nr, save_counter, save_limit
    logical :: is_eq, counting

    save_counter = 0
    counting = .false.
    call get_save_limit(save_limit)
    call reset_saved_execution_data()

    do i = 1, n
    call random_number(ran_time)
    call random_number(ran_proc)
    call random_number(ran_site)

    !For debugging
    if (debug > 2) then
        print *,"PROCLIST/DO_ACC_KMC_STEPS/RAN_TIME",ran_time
        print *,"PROCLIST/DO_ACC_KMC_STEPS/RAN_PROC",ran_proc
        print *,"PROCLIST/DO_ACC_KMC_STEPS/RAN_site",ran_site
    endif

    call update_accum_rate
    call update_clocks(ran_time)

    call update_integ_rate
    call update_integ_counter
    call update_integ_rate_sb
    call determine_procsite(ran_proc, ran_site, proc_nr, nr_site)

    !For debugging
    if (debug > 2) then
        print *,"PROCLIST/DO_ACC_KMC_STEPS/PROC_NR", proc_nr
        print *,"PROCLIST/DO_ACC_KMC_STEPS/SITE", nr_site
    endif

    call run_proc_nr(proc_nr, nr_site)

    call update_eq_proc(proc_nr) 
    call check_proc_eq(proc_nr, is_eq)
    counter_sp = counter_sp + 1

    if (save_exe) then
        if (counting .eqv. .false.) then
            if (proc_nr .eq. save_proc) then
                counting = .true.
                save_counter = save_counter + 1
                call save_execution(proc_nr,save_counter)
            endif
        else
            if (save_counter < save_limit) then
                save_counter = save_counter + 1
                call save_execution(proc_nr,save_counter)
            endif
        endif
    endif

    !For debugging
    if (debug > 2) then
        print *,"PROCLIST/DO_ACC_KMC_STEPS/IS_EQ", is_eq
        print *,"PROCLIST/DO_ACC_KMC_STEPS/COUNTER_SP", counter_sp
        print *,""
    endif

    if (.not. is_eq) then
        if (debug > 0) then
            print *,"IRREV. PROC EXECUTED:", proc_nr
        endif
        if (stats) then
            call update_sum_sf(counter_sp-counter_ini)
            counter_ini = 0
        endif
        call unscale_reactions
        counter_sp = 0
    endif
    if (counter_sp.gt.sampling_steps) then
        if (debug > 1) then
            print *,"PROCLIST/DO_ACC_KMC_STEPS: REACTIONS SCALED"
        endif
        if (stats) then
            call update_sum_sf(counter_sp-counter_ini)
            counter_ini = 0
        endif
        call scale_reactions
        counter_sp = 0
    endif
    enddo
    if (stats) then
        call update_sum_sf(counter_sp-counter_ini)
        counter_ini = counter_sp
    endif
end subroutine do_acc_kmc_steps

subroutine do_kmc_step()

!****f* proclist/do_kmc_step
! FUNCTION
!    Performs exactly one kMC step.
!    *  first update clock
!    *  then configuration sampling step
!    *  last execute process
!
! ARGUMENTS
!
!    ``none``
!******
    real(kind=rsingle) :: ran_proc, ran_time, ran_site
    integer(kind=iint) :: nr_site, proc_nr

    call random_number(ran_time)
    call random_number(ran_proc)
    call random_number(ran_site)
    call update_accum_rate
    call update_clocks(ran_time)

    call update_integ_rate
    call update_integ_counter
    call determine_procsite(ran_proc, ran_site, proc_nr, nr_site)
    call run_proc_nr(proc_nr, nr_site)
end subroutine do_kmc_step

subroutine get_next_kmc_step(proc_nr, nr_site)

!****f* proclist/get_kmc_step
! FUNCTION
!    Determines next step without executing it.
!
! ARGUMENTS
!
!    ``none``
!******
    real(kind=rsingle) :: ran_proc, ran_time, ran_site
    integer(kind=iint), intent(out) :: nr_site, proc_nr

    call random_number(ran_time)
    call random_number(ran_proc)
    call random_number(ran_site)
    call update_accum_rate
    call determine_procsite(ran_proc, ran_time, proc_nr, nr_site)

end subroutine get_next_kmc_step

subroutine get_occupation(occupation)

!****f* proclist/get_occupation
! FUNCTION
!    Evaluate current lattice configuration and returns
!    the normalized occupation as matrix. Different species
!    run along the first axis and different sites run
!    along the second.
!
! ARGUMENTS
!
!    ``none``
!******
    ! nr_of_species = 8, spuck = 3
    real(kind=rdouble), dimension(0:7, 1:3), intent(out) :: occupation

    integer(kind=iint) :: i, j, k, nr, species

    occupation = 0

    do k = 0, system_size(3)-1
        do j = 0, system_size(2)-1
            do i = 0, system_size(1)-1
                do nr = 1, spuck
                    ! shift position by 1, so it can be accessed
                    ! more straightforwardly from f2py interface
                    species = get_species((/i,j,k,nr/))
                    if(species.ne.null_species) then
                    occupation(species, nr) = &
                        occupation(species, nr) + 1
                    endif
                end do
            end do
        end do
    end do

    occupation = occupation/real(system_size(1)*system_size(2)*system_size(3))
end subroutine get_occupation

subroutine init(input_system_size, system_name, layer, seed_in, buffer_parameter, threshold_parameter, execution_steps, save_limit, no_banner)

!****f* proclist/init
! FUNCTION
!     Allocates the system and initializes all sites in the given
!     layer.
!
! ARGUMENTS
!
!    * ``input_system_size`` number of unit cell per axis.
!    * ``system_name`` identifier for reload file.
!    * ``layer`` initial layer.
!    * ``buffer_parameter`` used for temporal acc. scheme.
!    * ``threshold_parameter`` used for temporal acc. scheme.
!    * ``execution_steps`` used for temporal acc. scheme.
!    * ``save_limit`` used for temporal acc. scheme.
!    * ``no_banner`` [optional] if True no copyright is issued.
!******
    integer(kind=iint), intent(in) :: layer, seed_in, execution_steps, save_limit
    real(kind=rdouble), intent(in) :: threshold_parameter, buffer_parameter
    integer(kind=iint), dimension(2), intent(in) :: input_system_size

    character(len=400), intent(in) :: system_name

    logical, optional, intent(in) :: no_banner

    if (.not. no_banner) then
        print *, "+------------------------------------------------------------+"
        print *, "|                                                            |"
        print *, "| This kMC Model 'Methanation_JCP2017' was written by        |"
        print *, "|                                                            |"
        print *, "|           Mie Andersen (mie.andersen@ch.tum.de)            |"
        print *, "|                                                            |"
        print *, "| and implemented with the help of kmcos,                    |"
        print *, "| which is distributed under GNU/GPL Version 3               |"
        print *, "| (C) Max J. Hoffmann mjhoffmann@gmail.com                   |"
        print *, "|                                                            |"
        print *, "| kmcos is distributed in the hope that it will be useful    |"
        print *, "| but WIHTOUT ANY WARRANTY; without even the implied         |"
        print *, "| waranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR     |"
        print *, "| PURPOSE. See the GNU General Public License for more       |"
        print *, "| details.                                                   |"
        print *, "|                                                            |"
        print *, "| If using kmcos for a publication, attribution is           |"
        print *, "| greatly appreciated.                                       |"
        print *, "| Hoffmann, M. J., Matera, S., & Reuter, K. (2014).          |"
        print *, "| kmos: A lattice kinetic Monte Carlo framework.             |"
        print *, "| Computer Physics Communications, 185(7), 2138-2150.        |"
        print *, "|                                                            |"
        print *, "| Development https://github.com/kmcos/kmcos                 |"
        print *, "| Documentation https://kmcos.readthedocs.org                |"
        print *, "| Reference https://dx.doi.org/10.1016/j.cpc.2014.04.003     |"
        print *, "|                                                            |"
        print *, "+------------------------------------------------------------+"
        print *, ""
        print *, ""
    endif
    call allocate_system(nr_of_proc, input_system_size, system_name, buffer_parameter, threshold_parameter, execution_steps, save_limit)
    call initialize_state(layer, seed_in)
    counter_sp = 0
    counter_ini = 0
    debug = 0
end subroutine init

subroutine initialize_state(layer, seed_in)

!****f* proclist/initialize_state
! FUNCTION
!    Initialize all sites and book-keeping array
!    for the given layer.
!
! ARGUMENTS
!
!    * ``layer`` integer representing layer
!******
    integer(kind=iint), intent(in) :: layer, seed_in

    integer(kind=iint) :: i, j, k, nr
    ! initialize random number generator
    allocate(seed_arr(seed_size))
    seed = seed_in
    seed_arr = seed
    call random_seed(seed_size)
    call random_seed(put=seed_arr)
    deallocate(seed_arr)
    do k = 0, system_size(3)-1
        do j = 0, system_size(2)-1
            do i = 0, system_size(1)-1
                do nr = 1, spuck
                    call reset_site((/i, j, k, nr/), null_species)
                end do
                select case(layer)
                case (Rh211)
                    call replace_species((/i, j, k, Rh211_s/), null_species, empty)
                    call replace_species((/i, j, k, Rh211_t/), null_species, empty)
                    call replace_species((/i, j, k, Rh211_f/), null_species, empty)
                end select
            end do
        end do
    end do

    do k = 0, system_size(3)-1
        do j = 0, system_size(2)-1
            do i = 0, system_size(1)-1
                select case(layer)
                case(Rh211)
                    call touchup_Rh211_s((/i, j, k, Rh211_s/))
                    call touchup_Rh211_t((/i, j, k, Rh211_t/))
                    call touchup_Rh211_f((/i, j, k, Rh211_f/))
                end select
            end do
        end do
    end do


end subroutine initialize_state

subroutine run_proc_nr(proc, nr_site)

!****f* proclist/run_proc_nr
! FUNCTION
!    Runs process ``proc`` on site ``nr_site``.
!
! ARGUMENTS
!
!    * ``proc`` integer representing the process number
!    * ``nr_site``  integer representing the site
!******
    integer(kind=iint), intent(in) :: proc
    integer(kind=iint), intent(in) :: nr_site

    integer(kind=iint), dimension(4) :: lsite

    call increment_procstat(proc)

    ! lsite = lattice_site, (vs. scalar site)
    lsite = nr2lattice(nr_site, :)

    select case(proc)
    case(CH2_diff_s_N_s)
        call take_CH2_Rh211_s(lsite + (/0, 1, 0, 0/))
        call put_CH2_Rh211_s(lsite)

    case(CH2_diff_s_s_N)
        call take_CH2_Rh211_s(lsite)
        call put_CH2_Rh211_s(lsite + (/0, 1, 0, 0/))

    case(CH2_diff_s_t)
        call take_CH2_Rh211_s(lsite)
        call put_CH2_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))

    case(CH2_diff_s_t_N)
        call take_CH2_Rh211_s(lsite)
        call put_CH2_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))

    case(CH2_diff_t_N_s)
        call take_CH2_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))
        call put_CH2_Rh211_s(lsite)

    case(CH2_diff_t_S_t)
        call take_CH2_Rh211_t(lsite)
        call put_CH2_Rh211_t(lsite + (/0, 1, 0, 0/))

    case(CH2_diff_t_s)
        call take_CH2_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))
        call put_CH2_Rh211_s(lsite)

    case(CH2_diff_t_t_S)
        call take_CH2_Rh211_t(lsite + (/0, 1, 0, 0/))
        call put_CH2_Rh211_t(lsite)

    case(CH2_s_E_dis_f)
        call put_CH_Rh211_f(lsite)
        call take_CH2_Rh211_s(lsite + (/1, 0, 0, Rh211_s - Rh211_f/))

    case(CH2_s_dis)
        call take_CH2_Rh211_s(lsite)
        call put_CH_Rh211_s(lsite)

    case(CH2_t_N_dis_f)
        call put_CH_Rh211_f(lsite)
        call take_CH2_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_f/))

    case(CH2_t_dis)
        call take_CH2_Rh211_t(lsite)
        call put_CH_Rh211_t(lsite)

    case(CH2_t_dis_f)
        call put_CH_Rh211_f(lsite)
        call take_CH2_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_f/))

    case(CH3_diff_s_N_s)
        call take_CH3_Rh211_s(lsite + (/0, 1, 0, 0/))
        call put_CH3_Rh211_s(lsite)

    case(CH3_diff_s_s_N)
        call take_CH3_Rh211_s(lsite)
        call put_CH3_Rh211_s(lsite + (/0, 1, 0, 0/))

    case(CH3_diff_s_t)
        call take_CH3_Rh211_s(lsite)
        call put_CH3_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))

    case(CH3_diff_s_t_N)
        call take_CH3_Rh211_s(lsite)
        call put_CH3_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))

    case(CH3_diff_t_N_s)
        call take_CH3_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))
        call put_CH3_Rh211_s(lsite)

    case(CH3_diff_t_S_t)
        call take_CH3_Rh211_t(lsite)
        call put_CH3_Rh211_t(lsite + (/0, 1, 0, 0/))

    case(CH3_diff_t_s)
        call take_CH3_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))
        call put_CH3_Rh211_s(lsite)

    case(CH3_diff_t_t_S)
        call take_CH3_Rh211_t(lsite + (/0, 1, 0, 0/))
        call put_CH3_Rh211_t(lsite)

    case(CH3_s_dis)
        call take_CH3_Rh211_s(lsite)
        call put_CH2_Rh211_s(lsite)

    case(CH3_t_dis)
        call take_CH3_Rh211_t(lsite)
        call put_CH2_Rh211_t(lsite)

    case(CH4_s_ads)
        call put_CH3_Rh211_s(lsite)

    case(CH4_t_ads)
        call put_CH3_Rh211_t(lsite)

    case(CH_diff_f_S_f)
        call take_CH_Rh211_f(lsite)
        call put_CH_Rh211_f(lsite + (/0, 1, 0, 0/))

    case(CH_diff_f_f_S)
        call take_CH_Rh211_f(lsite + (/0, 1, 0, 0/))
        call put_CH_Rh211_f(lsite)

    case(CH_diff_f_s_E)
        call take_CH_Rh211_f(lsite)
        call put_CH_Rh211_s(lsite + (/1, 0, 0, Rh211_s - Rh211_f/))

    case(CH_diff_f_t)
        call take_CH_Rh211_f(lsite)
        call put_CH_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_f/))

    case(CH_diff_f_t_N)
        call take_CH_Rh211_f(lsite)
        call put_CH_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_f/))

    case(CH_diff_s_E_f)
        call take_CH_Rh211_s(lsite + (/1, 0, 0, Rh211_s - Rh211_f/))
        call put_CH_Rh211_f(lsite)

    case(CH_diff_s_N_s)
        call take_CH_Rh211_s(lsite + (/0, 1, 0, 0/))
        call put_CH_Rh211_s(lsite)

    case(CH_diff_s_s_N)
        call take_CH_Rh211_s(lsite)
        call put_CH_Rh211_s(lsite + (/0, 1, 0, 0/))

    case(CH_diff_s_t)
        call take_CH_Rh211_s(lsite)
        call put_CH_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))

    case(CH_diff_s_t_N)
        call take_CH_Rh211_s(lsite)
        call put_CH_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))

    case(CH_diff_t_N_f)
        call take_CH_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_f/))
        call put_CH_Rh211_f(lsite)

    case(CH_diff_t_N_s)
        call take_CH_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))
        call put_CH_Rh211_s(lsite)

    case(CH_diff_t_S_t)
        call take_CH_Rh211_t(lsite)
        call put_CH_Rh211_t(lsite + (/0, 1, 0, 0/))

    case(CH_diff_t_f)
        call take_CH_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_f/))
        call put_CH_Rh211_f(lsite)

    case(CH_diff_t_s)
        call take_CH_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))
        call put_CH_Rh211_s(lsite)

    case(CH_diff_t_t_S)
        call take_CH_Rh211_t(lsite + (/0, 1, 0, 0/))
        call put_CH_Rh211_t(lsite)

    case(CH_f_dis)
        call take_CH_Rh211_f(lsite)
        call put_C_Rh211_f(lsite)

    case(CH_s_dis)
        call take_CH_Rh211_s(lsite)
        call put_C_Rh211_s(lsite)

    case(CH_t_dis)
        call take_CH_Rh211_t(lsite)
        call put_C_Rh211_t(lsite)

    case(CO_ads_s)
        call put_CO_Rh211_s(lsite)

    case(CO_ads_t)
        call put_CO_Rh211_t(lsite)

    case(CO_des_s)
        call take_CO_Rh211_s(lsite)

    case(CO_des_t)
        call take_CO_Rh211_t(lsite)

    case(CO_diff_s_N_s)
        call take_CO_Rh211_s(lsite + (/0, 1, 0, 0/))
        call put_CO_Rh211_s(lsite)

    case(CO_diff_s_s_N)
        call take_CO_Rh211_s(lsite)
        call put_CO_Rh211_s(lsite + (/0, 1, 0, 0/))

    case(CO_diff_s_t)
        call take_CO_Rh211_s(lsite)
        call put_CO_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))

    case(CO_diff_s_t_N)
        call take_CO_Rh211_s(lsite)
        call put_CO_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))

    case(CO_diff_t_N_s)
        call take_CO_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))
        call put_CO_Rh211_s(lsite)

    case(CO_diff_t_S_t)
        call take_CO_Rh211_t(lsite)
        call put_CO_Rh211_t(lsite + (/0, 1, 0, 0/))

    case(CO_diff_t_s)
        call take_CO_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))
        call put_CO_Rh211_s(lsite)

    case(CO_diff_t_t_S)
        call take_CO_Rh211_t(lsite + (/0, 1, 0, 0/))
        call put_CO_Rh211_t(lsite)

    case(C_OH_s_react_t_NW)
        call put_CO_Rh211_s(lsite + (/1, 0, 0, Rh211_s - Rh211_f/))
        call take_C_Rh211_f(lsite)
        call take_OH_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_f/))

    case(C_OH_s_react_t_W)
        call put_CO_Rh211_s(lsite + (/1, 0, 0, Rh211_s - Rh211_f/))
        call take_C_Rh211_f(lsite)
        call take_OH_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_f/))

    case(C_OH_t_react_f)
        call take_C_Rh211_f(lsite)
        call take_OH_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_f/))
        call put_CO_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_f/))

    case(C_OH_t_react_f_S)
        call take_C_Rh211_f(lsite)
        call take_OH_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_f/))
        call put_CO_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_f/))

    case(C_diff_f_S_f)
        call take_C_Rh211_f(lsite)
        call put_C_Rh211_f(lsite + (/0, 1, 0, 0/))

    case(C_diff_f_f_S)
        call take_C_Rh211_f(lsite + (/0, 1, 0, 0/))
        call put_C_Rh211_f(lsite)

    case(C_diff_f_s_E)
        call take_C_Rh211_f(lsite)
        call put_C_Rh211_s(lsite + (/1, 0, 0, Rh211_s - Rh211_f/))

    case(C_diff_f_t)
        call take_C_Rh211_f(lsite)
        call put_C_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_f/))

    case(C_diff_f_t_N)
        call take_C_Rh211_f(lsite)
        call put_C_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_f/))

    case(C_diff_s_E_f)
        call take_C_Rh211_s(lsite + (/1, 0, 0, Rh211_s - Rh211_f/))
        call put_C_Rh211_f(lsite)

    case(C_diff_s_N_s)
        call take_C_Rh211_s(lsite + (/0, 1, 0, 0/))
        call put_C_Rh211_s(lsite)

    case(C_diff_s_s_N)
        call take_C_Rh211_s(lsite)
        call put_C_Rh211_s(lsite + (/0, 1, 0, 0/))

    case(C_diff_s_t)
        call take_C_Rh211_s(lsite)
        call put_C_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))

    case(C_diff_s_t_N)
        call take_C_Rh211_s(lsite)
        call put_C_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))

    case(C_diff_t_N_f)
        call take_C_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_f/))
        call put_C_Rh211_f(lsite)

    case(C_diff_t_N_s)
        call take_C_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))
        call put_C_Rh211_s(lsite)

    case(C_diff_t_S_t)
        call take_C_Rh211_t(lsite)
        call put_C_Rh211_t(lsite + (/0, 1, 0, 0/))

    case(C_diff_t_f)
        call take_C_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_f/))
        call put_C_Rh211_f(lsite)

    case(C_diff_t_s)
        call take_C_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))
        call put_C_Rh211_s(lsite)

    case(C_diff_t_t_S)
        call take_C_Rh211_t(lsite + (/0, 1, 0, 0/))
        call put_C_Rh211_t(lsite)

    case(H2O_O_s_react_s_N)
        call take_O_Rh211_s(lsite)
        call put_OH_Rh211_s(lsite)
        call put_OH_Rh211_s(lsite + (/0, 1, 0, 0/))

    case(H2O_O_s_react_s_S)
        call take_O_Rh211_s(lsite + (/0, 1, 0, 0/))
        call put_OH_Rh211_s(lsite + (/0, 1, 0, 0/))
        call put_OH_Rh211_s(lsite)

    case(H2O_O_s_react_t)
        call take_O_Rh211_s(lsite)
        call put_OH_Rh211_s(lsite)
        call put_OH_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))

    case(H2O_O_s_react_t_N)
        call take_O_Rh211_s(lsite)
        call put_OH_Rh211_s(lsite)
        call put_OH_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))

    case(H2O_O_t_N_react_s)
        call take_O_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))
        call put_OH_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))
        call put_OH_Rh211_s(lsite)

    case(H2O_O_t_react_s)
        call take_O_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))
        call put_OH_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))
        call put_OH_Rh211_s(lsite)

    case(H2O_O_t_react_t_N)
        call take_O_Rh211_t(lsite)
        call put_OH_Rh211_t(lsite)
        call put_OH_Rh211_t(lsite + (/0, 1, 0, 0/))

    case(H2O_O_t_react_t_S)
        call take_O_Rh211_t(lsite + (/0, 1, 0, 0/))
        call put_OH_Rh211_t(lsite + (/0, 1, 0, 0/))
        call put_OH_Rh211_t(lsite)

    case(H2O_s_ads)
        call put_OH_Rh211_s(lsite)

    case(H2O_t_ads)
        call put_OH_Rh211_t(lsite)

    case(H_CH2_s_react)
        call take_CH2_Rh211_s(lsite)
        call put_CH3_Rh211_s(lsite)

    case(H_CH2_t_react)
        call take_CH2_Rh211_t(lsite)
        call put_CH3_Rh211_t(lsite)

    case(H_CH3_s_react)
        call take_CH3_Rh211_s(lsite)

    case(H_CH3_t_react)
        call take_CH3_Rh211_t(lsite)

    case(H_CH_f_react_s_E)
        call take_CH_Rh211_f(lsite)
        call put_CH2_Rh211_s(lsite + (/1, 0, 0, Rh211_s - Rh211_f/))

    case(H_CH_f_react_t)
        call take_CH_Rh211_f(lsite)
        call put_CH2_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_f/))

    case(H_CH_f_react_t_N)
        call take_CH_Rh211_f(lsite)
        call put_CH2_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_f/))

    case(H_CH_s_react)
        call take_CH_Rh211_s(lsite)
        call put_CH2_Rh211_s(lsite)

    case(H_CH_t_react)
        call take_CH_Rh211_t(lsite)
        call put_CH2_Rh211_t(lsite)

    case(H_CO_s_react_t_NW)
        call take_CO_Rh211_s(lsite + (/1, 0, 0, Rh211_s - Rh211_f/))
        call put_C_Rh211_f(lsite)
        call put_OH_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_f/))

    case(H_CO_s_react_t_W)
        call take_CO_Rh211_s(lsite + (/1, 0, 0, Rh211_s - Rh211_f/))
        call put_C_Rh211_f(lsite)
        call put_OH_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_f/))

    case(H_CO_t_react_f)
        call take_CO_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_f/))
        call put_OH_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_f/))
        call put_C_Rh211_f(lsite)

    case(H_CO_t_react_f_S)
        call take_CO_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_f/))
        call put_OH_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_f/))
        call put_C_Rh211_f(lsite)

    case(H_C_f_react)
        call take_C_Rh211_f(lsite)
        call put_CH_Rh211_f(lsite)

    case(H_C_s_react)
        call take_C_Rh211_s(lsite)
        call put_CH_Rh211_s(lsite)

    case(H_C_t_react)
        call take_C_Rh211_t(lsite)
        call put_CH_Rh211_t(lsite)

    case(H_OH_s_react)
        call take_OH_Rh211_s(lsite)

    case(H_OH_t_react)
        call take_OH_Rh211_t(lsite)

    case(H_O_s_react)
        call take_O_Rh211_s(lsite)
        call put_OH_Rh211_s(lsite)

    case(H_O_t_react)
        call take_O_Rh211_t(lsite)
        call put_OH_Rh211_t(lsite)

    case(OH_OH_s_react_s_N)
        call take_OH_Rh211_s(lsite)
        call put_O_Rh211_s(lsite)
        call take_OH_Rh211_s(lsite + (/0, 1, 0, 0/))

    case(OH_OH_s_react_s_S)
        call take_OH_Rh211_s(lsite + (/0, 1, 0, 0/))
        call put_O_Rh211_s(lsite + (/0, 1, 0, 0/))
        call take_OH_Rh211_s(lsite)

    case(OH_OH_s_react_t)
        call take_OH_Rh211_s(lsite)
        call put_O_Rh211_s(lsite)
        call take_OH_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))

    case(OH_OH_s_react_t_N)
        call take_OH_Rh211_s(lsite)
        call put_O_Rh211_s(lsite)
        call take_OH_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))

    case(OH_OH_t_N_react_s)
        call take_OH_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))
        call put_O_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))
        call take_OH_Rh211_s(lsite)

    case(OH_OH_t_react_s)
        call take_OH_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))
        call put_O_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))
        call take_OH_Rh211_s(lsite)

    case(OH_OH_t_react_t_N)
        call take_OH_Rh211_t(lsite)
        call put_O_Rh211_t(lsite)
        call take_OH_Rh211_t(lsite + (/0, 1, 0, 0/))

    case(OH_OH_t_react_t_S)
        call take_OH_Rh211_t(lsite + (/0, 1, 0, 0/))
        call put_O_Rh211_t(lsite + (/0, 1, 0, 0/))
        call take_OH_Rh211_t(lsite)

    case(OH_diff_s_N_s)
        call take_OH_Rh211_s(lsite + (/0, 1, 0, 0/))
        call put_OH_Rh211_s(lsite)

    case(OH_diff_s_s_N)
        call take_OH_Rh211_s(lsite)
        call put_OH_Rh211_s(lsite + (/0, 1, 0, 0/))

    case(OH_diff_s_t)
        call take_OH_Rh211_s(lsite)
        call put_OH_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))

    case(OH_diff_s_t_N)
        call take_OH_Rh211_s(lsite)
        call put_OH_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))

    case(OH_diff_t_N_s)
        call take_OH_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))
        call put_OH_Rh211_s(lsite)

    case(OH_diff_t_S_t)
        call take_OH_Rh211_t(lsite)
        call put_OH_Rh211_t(lsite + (/0, 1, 0, 0/))

    case(OH_diff_t_s)
        call take_OH_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))
        call put_OH_Rh211_s(lsite)

    case(OH_diff_t_t_S)
        call take_OH_Rh211_t(lsite + (/0, 1, 0, 0/))
        call put_OH_Rh211_t(lsite)

    case(OH_s_dis)
        call take_OH_Rh211_s(lsite)
        call put_O_Rh211_s(lsite)

    case(OH_t_dis)
        call take_OH_Rh211_t(lsite)
        call put_O_Rh211_t(lsite)

    case(O_diff_s_N_s)
        call take_O_Rh211_s(lsite + (/0, 1, 0, 0/))
        call put_O_Rh211_s(lsite)

    case(O_diff_s_s_N)
        call take_O_Rh211_s(lsite)
        call put_O_Rh211_s(lsite + (/0, 1, 0, 0/))

    case(O_diff_s_t)
        call take_O_Rh211_s(lsite)
        call put_O_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))

    case(O_diff_s_t_N)
        call take_O_Rh211_s(lsite)
        call put_O_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))

    case(O_diff_t_N_s)
        call take_O_Rh211_t(lsite + (/0, 1, 0, Rh211_t - Rh211_s/))
        call put_O_Rh211_s(lsite)

    case(O_diff_t_S_t)
        call take_O_Rh211_t(lsite)
        call put_O_Rh211_t(lsite + (/0, 1, 0, 0/))

    case(O_diff_t_s)
        call take_O_Rh211_t(lsite + (/0, 0, 0, Rh211_t - Rh211_s/))
        call put_O_Rh211_s(lsite)

    case(O_diff_t_t_S)
        call take_O_Rh211_t(lsite + (/0, 1, 0, 0/))
        call put_O_Rh211_t(lsite)

    end select

end subroutine run_proc_nr

subroutine put_C_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, C)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_s_N_s, site)
    endif

    if(avail_sites(CH2_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_N_s, site)
    endif

    if(avail_sites(CH2_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_s, site)
    endif

    if(avail_sites(CH3_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_s_N_s, site)
    endif

    if(avail_sites(CH3_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_N_s, site)
    endif

    if(avail_sites(CH3_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_s, site)
    endif

    if(avail_sites(CH4_s_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH4_s_ads, site)
    endif

    if(avail_sites(CH_diff_f_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(CH_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(CH_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_N_s, site)
    endif

    if(avail_sites(CH_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_N_s, site)
    endif

    if(avail_sites(CH_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_s, site)
    endif

    if(avail_sites(CO_ads_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_ads_s, site)
    endif

    if(avail_sites(CO_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_s_N_s, site)
    endif

    if(avail_sites(CO_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_N_s, site)
    endif

    if(avail_sites(CO_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_s, site)
    endif

    if(avail_sites(C_OH_s_react_t_NW, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_OH_s_react_t_W, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_f_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_N_s, site)
    endif

    if(avail_sites(C_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_N_s, site)
    endif

    if(avail_sites(C_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_s, site)
    endif

    if(avail_sites(H2O_O_s_react_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_s_react_s_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_S, site)
    endif

    if(avail_sites(H2O_O_t_N_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_N_react_s, site)
    endif

    if(avail_sites(H2O_O_t_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_s, site)
    endif

    if(avail_sites(H2O_s_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_s_ads, site)
    endif

    if(avail_sites(H_CH_f_react_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(H_CH_f_react_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(OH_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_s_N_s, site)
    endif

    if(avail_sites(OH_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_N_s, site)
    endif

    if(avail_sites(OH_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_s, site)
    endif

    if(avail_sites(O_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_s_N_s, site)
    endif

    if(avail_sites(O_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_N_s, site)
    endif

    if(avail_sites(O_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_s, site)
    endif

    ! enable affected processes
    call add_proc(H_C_s_react, site)
    select case(get_species(site + (/-1, 0, 0, Rh211_f - Rh211_s/)))
    case(empty)
        call add_proc(C_diff_s_E_f, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(C_diff_s_N_s, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(C_diff_s_s_N, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
    case(empty)
        call add_proc(C_diff_s_t, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
    case(empty)
        call add_proc(C_diff_s_t_N, site)
    end select


end subroutine put_C_Rh211_s

subroutine take_C_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, C, empty)

    ! disable affected processes
    if(avail_sites(C_diff_s_E_f, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_diff_s_E_f, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_s_N_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_s_N_s, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_s_s_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_s_N, site)
    endif

    if(avail_sites(C_diff_s_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_t, site)
    endif

    if(avail_sites(C_diff_s_t_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_t_N, site)
    endif

    if(avail_sites(H_C_s_react, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_C_s_react, site)
    endif

    ! enable affected processes
    call add_proc(CH4_s_ads, site)
    call add_proc(CO_ads_s, site)
    call add_proc(H2O_s_ads, site)
    select case(get_species(site + (/0, 1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_s_N_s, site)
    case(C)
        call add_proc(C_diff_s_N_s, site)
    case(CH3)
        call add_proc(CH3_diff_s_N_s, site)
    case(O)
        call add_proc(H2O_O_s_react_s_S, site)
        call add_proc(O_diff_s_N_s, site)
    case(CH2)
        call add_proc(CH2_diff_s_N_s, site)
    case(CO)
        call add_proc(CO_diff_s_N_s, site)
    case(OH)
        call add_proc(OH_diff_s_N_s, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(C)
        call add_proc(C_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CH3)
        call add_proc(CH3_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(O)
        call add_proc(H2O_O_s_react_s_N, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CH2)
        call add_proc(CH2_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CO)
        call add_proc(CO_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_diff_s_s_N, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
    case(CH)
        call add_proc(CH_diff_t_N_s, site)
    case(C)
        call add_proc(C_diff_t_N_s, site)
    case(CH3)
        call add_proc(CH3_diff_t_N_s, site)
    case(O)
        call add_proc(H2O_O_t_N_react_s, site)
        call add_proc(O_diff_t_N_s, site)
    case(CH2)
        call add_proc(CH2_diff_t_N_s, site)
    case(CO)
        call add_proc(CO_diff_t_N_s, site)
    case(OH)
        call add_proc(OH_diff_t_N_s, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
    case(CH)
        call add_proc(CH_diff_t_s, site)
    case(C)
        call add_proc(C_diff_t_s, site)
    case(CH3)
        call add_proc(CH3_diff_t_s, site)
    case(O)
        call add_proc(H2O_O_t_react_s, site)
        call add_proc(O_diff_t_s, site)
    case(CH2)
        call add_proc(CH2_diff_t_s, site)
    case(CO)
        call add_proc(CO_diff_t_s, site)
    case(OH)
        call add_proc(OH_diff_t_s, site)
    end select

    select case(get_species(site + (/-1, 0, 0, Rh211_f - Rh211_s/)))
    case(C)
        call add_proc(C_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        select case(get_species(site + (/-1, 1, 0, Rh211_t - Rh211_s/)))
        case(OH)
            call add_proc(C_OH_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

        select case(get_species(site + (/-1, 0, 0, Rh211_t - Rh211_s/)))
        case(OH)
            call add_proc(C_OH_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

    case(CH)
        call add_proc(CH_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        call add_proc(H_CH_f_react_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    end select


end subroutine take_C_Rh211_s

subroutine put_C_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, C)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_t_S, site)
    endif

    if(avail_sites(CH3_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_t_S, site)
    endif

    if(avail_sites(CH4_t_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH4_t_ads, site)
    endif

    if(avail_sites(CH_diff_f_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_f_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_t_S, site)
    endif

    if(avail_sites(CO_ads_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_ads_t, site)
    endif

    if(avail_sites(CO_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_t_S, site)
    endif

    if(avail_sites(C_diff_f_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_f_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_t_S, site)
    endif

    if(avail_sites(H2O_O_s_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_s_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_t_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_t_react_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_S, site)
    endif

    if(avail_sites(H2O_t_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_t_ads, site)
    endif

    if(avail_sites(H_CH_f_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CH_f_react_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CH_f_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CH_f_react_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(OH_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_t_S, site)
    endif

    if(avail_sites(O_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_t_S, site)
    endif

    ! enable affected processes
    call add_proc(H_C_t_react, site)
    select case(get_species(site + (/0, -1, 0, Rh211_f - Rh211_t/)))
    case(empty)
        call add_proc(C_diff_t_N_f, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_s - Rh211_t/)))
    case(empty)
        call add_proc(C_diff_t_N_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(C_diff_t_S_t, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_f - Rh211_t/)))
    case(empty)
        call add_proc(C_diff_t_f, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_s - Rh211_t/)))
    case(empty)
        call add_proc(C_diff_t_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(C_diff_t_t_S, site + (/0, -1, 0, 0/))
    end select


end subroutine put_C_Rh211_t

subroutine take_C_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, C, empty)

    ! disable affected processes
    if(avail_sites(C_diff_t_N_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_t_N_f, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_t_N_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_t_N_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_t_S_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_S_t, site)
    endif

    if(avail_sites(C_diff_t_f, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_t_f, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_t_s, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_t_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_t_t_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_t_t_S, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H_C_t_react, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_C_t_react, site)
    endif

    ! enable affected processes
    call add_proc(CH4_t_ads, site)
    call add_proc(CO_ads_t, site)
    call add_proc(H2O_t_ads, site)
    select case(get_species(site + (/0, 0, 0, Rh211_s - Rh211_t/)))
    case(CH)
        call add_proc(CH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(C)
        call add_proc(C_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CH3)
        call add_proc(CH3_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(O)
        call add_proc(H2O_O_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CH2)
        call add_proc(CH2_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CO)
        call add_proc(CO_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_s - Rh211_t/)))
    case(CH)
        call add_proc(CH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(C)
        call add_proc(C_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CH3)
        call add_proc(CH3_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(O)
        call add_proc(H2O_O_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CH2)
        call add_proc(CH2_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CO)
        call add_proc(CO_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(C)
        call add_proc(C_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CH3)
        call add_proc(CH3_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(O)
        call add_proc(H2O_O_t_react_t_N, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CH2)
        call add_proc(CH2_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CO)
        call add_proc(CO_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_diff_t_S_t, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_t_t_S, site)
    case(C)
        call add_proc(C_diff_t_t_S, site)
    case(CH3)
        call add_proc(CH3_diff_t_t_S, site)
    case(O)
        call add_proc(H2O_O_t_react_t_S, site)
        call add_proc(O_diff_t_t_S, site)
    case(CH2)
        call add_proc(CH2_diff_t_t_S, site)
    case(CO)
        call add_proc(CO_diff_t_t_S, site)
    case(OH)
        call add_proc(OH_diff_t_t_S, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    case(empty)
        select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_t/)))
        case(CO)
            call add_proc(H_CO_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        end select

    case(CH)
        call add_proc(CH_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        call add_proc(H_CH_f_react_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    case(empty)
        select case(get_species(site + (/1, -1, 0, Rh211_s - Rh211_t/)))
        case(CO)
            call add_proc(H_CO_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        end select

    case(CH)
        call add_proc(CH_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        call add_proc(H_CH_f_react_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    end select


end subroutine take_C_Rh211_t

subroutine put_C_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, C)

    ! disable affected processes
    if(avail_sites(CH2_s_E_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_s_E_dis_f, site)
    endif

    if(avail_sites(CH2_t_N_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_N_dis_f, site)
    endif

    if(avail_sites(CH2_t_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_dis_f, site)
    endif

    if(avail_sites(CH_diff_f_S_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_f_S_f, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_f_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_f_f_S, site)
    endif

    if(avail_sites(CH_diff_s_E_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_E_f, site)
    endif

    if(avail_sites(CH_diff_t_N_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_N_f, site)
    endif

    if(avail_sites(CH_diff_t_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_f, site)
    endif

    if(avail_sites(C_diff_f_S_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_f_S_f, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_f_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_f_f_S, site)
    endif

    if(avail_sites(C_diff_s_E_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_E_f, site)
    endif

    if(avail_sites(C_diff_t_N_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_N_f, site)
    endif

    if(avail_sites(C_diff_t_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_f, site)
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site)
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site)
    endif

    if(avail_sites(H_CO_t_react_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_t_react_f, site)
    endif

    if(avail_sites(H_CO_t_react_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_t_react_f_S, site)
    endif

    ! enable affected processes
    call add_proc(H_C_f_react, site)
    select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_f/)))
    case(empty)
        call add_proc(C_diff_f_s_E, site)
        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
        case(OH)
            call add_proc(C_OH_s_react_t_NW, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
        case(OH)
            call add_proc(C_OH_s_react_t_W, site)
        end select

    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
    case(empty)
        call add_proc(C_diff_f_t, site)
    case(OH)
        call add_proc(C_OH_t_react_f, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
    case(empty)
        call add_proc(C_diff_f_t_N, site)
    case(OH)
        call add_proc(C_OH_t_react_f_S, site)
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(C_diff_f_S_f, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(C_diff_f_f_S, site + (/0, -1, 0, 0/))
    end select


end subroutine put_C_Rh211_f

subroutine take_C_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, C, empty)

    ! disable affected processes
    if(avail_sites(C_OH_s_react_t_NW, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_NW, site)
    endif

    if(avail_sites(C_OH_s_react_t_W, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_W, site)
    endif

    if(avail_sites(C_OH_t_react_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_OH_t_react_f, site)
    endif

    if(avail_sites(C_OH_t_react_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_OH_t_react_f_S, site)
    endif

    if(avail_sites(C_diff_f_S_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_f_S_f, site)
    endif

    if(avail_sites(C_diff_f_f_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_f_f_S, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_f_s_E, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_f_s_E, site)
    endif

    if(avail_sites(C_diff_f_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_f_t, site)
    endif

    if(avail_sites(C_diff_f_t_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_f_t_N, site)
    endif

    if(avail_sites(H_C_f_react, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_C_f_react, site)
    endif

    ! enable affected processes
    select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_f/)))
    case(C)
        call add_proc(C_diff_s_E_f, site)
    case(CH2)
        call add_proc(CH2_s_E_dis_f, site)
    case(CO)
        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(H_CO_s_react_t_NW, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(H_CO_s_react_t_W, site)
        end select

    case(CH)
        call add_proc(CH_diff_s_E_f, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
    case(C)
        call add_proc(C_diff_t_N_f, site)
    case(CH2)
        call add_proc(CH2_t_N_dis_f, site)
    case(CO)
        call add_proc(H_CO_t_react_f_S, site)
    case(CH)
        call add_proc(CH_diff_t_N_f, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
    case(C)
        call add_proc(C_diff_t_f, site)
    case(CH2)
        call add_proc(CH2_t_dis_f, site)
    case(CO)
        call add_proc(H_CO_t_react_f, site)
    case(CH)
        call add_proc(CH_diff_t_f, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(C)
        call add_proc(C_diff_f_S_f, site + (/0, -1, 0, 0/))
    case(CH)
        call add_proc(CH_diff_f_S_f, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(C)
        call add_proc(C_diff_f_f_S, site)
    case(CH)
        call add_proc(CH_diff_f_f_S, site)
    end select


end subroutine take_C_Rh211_f

subroutine put_CH_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, CH)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_s_N_s, site)
    endif

    if(avail_sites(CH2_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_N_s, site)
    endif

    if(avail_sites(CH2_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_s, site)
    endif

    if(avail_sites(CH3_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_s_N_s, site)
    endif

    if(avail_sites(CH3_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_N_s, site)
    endif

    if(avail_sites(CH3_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_s, site)
    endif

    if(avail_sites(CH4_s_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH4_s_ads, site)
    endif

    if(avail_sites(CH_diff_f_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(CH_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(CH_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_N_s, site)
    endif

    if(avail_sites(CH_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_N_s, site)
    endif

    if(avail_sites(CH_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_s, site)
    endif

    if(avail_sites(CO_ads_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_ads_s, site)
    endif

    if(avail_sites(CO_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_s_N_s, site)
    endif

    if(avail_sites(CO_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_N_s, site)
    endif

    if(avail_sites(CO_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_s, site)
    endif

    if(avail_sites(C_OH_s_react_t_NW, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_OH_s_react_t_W, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_f_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_N_s, site)
    endif

    if(avail_sites(C_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_N_s, site)
    endif

    if(avail_sites(C_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_s, site)
    endif

    if(avail_sites(H2O_O_s_react_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_s_react_s_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_S, site)
    endif

    if(avail_sites(H2O_O_t_N_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_N_react_s, site)
    endif

    if(avail_sites(H2O_O_t_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_s, site)
    endif

    if(avail_sites(H2O_s_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_s_ads, site)
    endif

    if(avail_sites(H_CH_f_react_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(H_CH_f_react_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(OH_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_s_N_s, site)
    endif

    if(avail_sites(OH_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_N_s, site)
    endif

    if(avail_sites(OH_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_s, site)
    endif

    if(avail_sites(O_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_s_N_s, site)
    endif

    if(avail_sites(O_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_N_s, site)
    endif

    if(avail_sites(O_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_s, site)
    endif

    ! enable affected processes
    call add_proc(CH_s_dis, site)
    call add_proc(H_CH_s_react, site)
    select case(get_species(site + (/-1, 0, 0, Rh211_f - Rh211_s/)))
    case(empty)
        call add_proc(CH_diff_s_E_f, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(CH_diff_s_N_s, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(CH_diff_s_s_N, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
    case(empty)
        call add_proc(CH_diff_s_t, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
    case(empty)
        call add_proc(CH_diff_s_t_N, site)
    end select


end subroutine put_CH_Rh211_s

subroutine take_CH_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, CH, empty)

    ! disable affected processes
    if(avail_sites(CH_diff_s_E_f, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(CH_diff_s_E_f, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(CH_diff_s_N_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_s_N_s, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_s_s_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_s_N, site)
    endif

    if(avail_sites(CH_diff_s_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_t, site)
    endif

    if(avail_sites(CH_diff_s_t_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_t_N, site)
    endif

    if(avail_sites(CH_s_dis, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_s_dis, site)
    endif

    if(avail_sites(H_CH_s_react, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CH_s_react, site)
    endif

    ! enable affected processes
    call add_proc(CH4_s_ads, site)
    call add_proc(CO_ads_s, site)
    call add_proc(H2O_s_ads, site)
    select case(get_species(site + (/0, 1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_s_N_s, site)
    case(C)
        call add_proc(C_diff_s_N_s, site)
    case(CH3)
        call add_proc(CH3_diff_s_N_s, site)
    case(O)
        call add_proc(H2O_O_s_react_s_S, site)
        call add_proc(O_diff_s_N_s, site)
    case(CH2)
        call add_proc(CH2_diff_s_N_s, site)
    case(CO)
        call add_proc(CO_diff_s_N_s, site)
    case(OH)
        call add_proc(OH_diff_s_N_s, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(C)
        call add_proc(C_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CH3)
        call add_proc(CH3_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(O)
        call add_proc(H2O_O_s_react_s_N, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CH2)
        call add_proc(CH2_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CO)
        call add_proc(CO_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_diff_s_s_N, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
    case(CH)
        call add_proc(CH_diff_t_N_s, site)
    case(C)
        call add_proc(C_diff_t_N_s, site)
    case(CH3)
        call add_proc(CH3_diff_t_N_s, site)
    case(O)
        call add_proc(H2O_O_t_N_react_s, site)
        call add_proc(O_diff_t_N_s, site)
    case(CH2)
        call add_proc(CH2_diff_t_N_s, site)
    case(CO)
        call add_proc(CO_diff_t_N_s, site)
    case(OH)
        call add_proc(OH_diff_t_N_s, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
    case(CH)
        call add_proc(CH_diff_t_s, site)
    case(C)
        call add_proc(C_diff_t_s, site)
    case(CH3)
        call add_proc(CH3_diff_t_s, site)
    case(O)
        call add_proc(H2O_O_t_react_s, site)
        call add_proc(O_diff_t_s, site)
    case(CH2)
        call add_proc(CH2_diff_t_s, site)
    case(CO)
        call add_proc(CO_diff_t_s, site)
    case(OH)
        call add_proc(OH_diff_t_s, site)
    end select

    select case(get_species(site + (/-1, 0, 0, Rh211_f - Rh211_s/)))
    case(C)
        call add_proc(C_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        select case(get_species(site + (/-1, 1, 0, Rh211_t - Rh211_s/)))
        case(OH)
            call add_proc(C_OH_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

        select case(get_species(site + (/-1, 0, 0, Rh211_t - Rh211_s/)))
        case(OH)
            call add_proc(C_OH_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

    case(CH)
        call add_proc(CH_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        call add_proc(H_CH_f_react_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    end select


end subroutine take_CH_Rh211_s

subroutine put_CH_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, CH)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_t_S, site)
    endif

    if(avail_sites(CH3_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_t_S, site)
    endif

    if(avail_sites(CH4_t_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH4_t_ads, site)
    endif

    if(avail_sites(CH_diff_f_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_f_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_t_S, site)
    endif

    if(avail_sites(CO_ads_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_ads_t, site)
    endif

    if(avail_sites(CO_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_t_S, site)
    endif

    if(avail_sites(C_diff_f_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_f_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_t_S, site)
    endif

    if(avail_sites(H2O_O_s_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_s_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_t_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_t_react_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_S, site)
    endif

    if(avail_sites(H2O_t_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_t_ads, site)
    endif

    if(avail_sites(H_CH_f_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CH_f_react_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CH_f_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CH_f_react_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(OH_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_t_S, site)
    endif

    if(avail_sites(O_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_t_S, site)
    endif

    ! enable affected processes
    call add_proc(CH_t_dis, site)
    call add_proc(H_CH_t_react, site)
    select case(get_species(site + (/0, -1, 0, Rh211_f - Rh211_t/)))
    case(empty)
        call add_proc(CH_diff_t_N_f, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_s - Rh211_t/)))
    case(empty)
        call add_proc(CH_diff_t_N_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(CH_diff_t_S_t, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_f - Rh211_t/)))
    case(empty)
        call add_proc(CH_diff_t_f, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_s - Rh211_t/)))
    case(empty)
        call add_proc(CH_diff_t_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(CH_diff_t_t_S, site + (/0, -1, 0, 0/))
    end select


end subroutine put_CH_Rh211_t

subroutine take_CH_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, CH, empty)

    ! disable affected processes
    if(avail_sites(CH_diff_t_N_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_t_N_f, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_t_N_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_t_N_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_t_S_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_S_t, site)
    endif

    if(avail_sites(CH_diff_t_f, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_t_f, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_t_s, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_t_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_t_t_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_t_t_S, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_t_dis, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_t_dis, site)
    endif

    if(avail_sites(H_CH_t_react, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CH_t_react, site)
    endif

    ! enable affected processes
    call add_proc(CH4_t_ads, site)
    call add_proc(CO_ads_t, site)
    call add_proc(H2O_t_ads, site)
    select case(get_species(site + (/0, 0, 0, Rh211_s - Rh211_t/)))
    case(CH)
        call add_proc(CH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(C)
        call add_proc(C_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CH3)
        call add_proc(CH3_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(O)
        call add_proc(H2O_O_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CH2)
        call add_proc(CH2_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CO)
        call add_proc(CO_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_s - Rh211_t/)))
    case(CH)
        call add_proc(CH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(C)
        call add_proc(C_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CH3)
        call add_proc(CH3_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(O)
        call add_proc(H2O_O_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CH2)
        call add_proc(CH2_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CO)
        call add_proc(CO_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(C)
        call add_proc(C_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CH3)
        call add_proc(CH3_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(O)
        call add_proc(H2O_O_t_react_t_N, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CH2)
        call add_proc(CH2_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CO)
        call add_proc(CO_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_diff_t_S_t, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_t_t_S, site)
    case(C)
        call add_proc(C_diff_t_t_S, site)
    case(CH3)
        call add_proc(CH3_diff_t_t_S, site)
    case(O)
        call add_proc(H2O_O_t_react_t_S, site)
        call add_proc(O_diff_t_t_S, site)
    case(CH2)
        call add_proc(CH2_diff_t_t_S, site)
    case(CO)
        call add_proc(CO_diff_t_t_S, site)
    case(OH)
        call add_proc(OH_diff_t_t_S, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    case(empty)
        select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_t/)))
        case(CO)
            call add_proc(H_CO_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        end select

    case(CH)
        call add_proc(CH_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        call add_proc(H_CH_f_react_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    case(empty)
        select case(get_species(site + (/1, -1, 0, Rh211_s - Rh211_t/)))
        case(CO)
            call add_proc(H_CO_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        end select

    case(CH)
        call add_proc(CH_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        call add_proc(H_CH_f_react_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    end select


end subroutine take_CH_Rh211_t

subroutine put_CH_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, CH)

    ! disable affected processes
    if(avail_sites(CH2_s_E_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_s_E_dis_f, site)
    endif

    if(avail_sites(CH2_t_N_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_N_dis_f, site)
    endif

    if(avail_sites(CH2_t_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_dis_f, site)
    endif

    if(avail_sites(CH_diff_f_S_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_f_S_f, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_f_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_f_f_S, site)
    endif

    if(avail_sites(CH_diff_s_E_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_E_f, site)
    endif

    if(avail_sites(CH_diff_t_N_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_N_f, site)
    endif

    if(avail_sites(CH_diff_t_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_f, site)
    endif

    if(avail_sites(C_diff_f_S_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_f_S_f, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_f_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_f_f_S, site)
    endif

    if(avail_sites(C_diff_s_E_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_E_f, site)
    endif

    if(avail_sites(C_diff_t_N_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_N_f, site)
    endif

    if(avail_sites(C_diff_t_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_f, site)
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site)
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site)
    endif

    if(avail_sites(H_CO_t_react_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_t_react_f, site)
    endif

    if(avail_sites(H_CO_t_react_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_t_react_f_S, site)
    endif

    ! enable affected processes
    call add_proc(CH_f_dis, site)
    select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_f/)))
    case(empty)
        call add_proc(CH_diff_f_s_E, site)
        call add_proc(H_CH_f_react_s_E, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
    case(empty)
        call add_proc(CH_diff_f_t, site)
        call add_proc(H_CH_f_react_t, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
    case(empty)
        call add_proc(CH_diff_f_t_N, site)
        call add_proc(H_CH_f_react_t_N, site)
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(CH_diff_f_S_f, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(CH_diff_f_f_S, site + (/0, -1, 0, 0/))
    end select


end subroutine put_CH_Rh211_f

subroutine take_CH_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, CH, empty)

    ! disable affected processes
    if(avail_sites(CH_diff_f_S_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_f_S_f, site)
    endif

    if(avail_sites(CH_diff_f_f_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_f_f_S, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_f_s_E, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_f_s_E, site)
    endif

    if(avail_sites(CH_diff_f_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_f_t, site)
    endif

    if(avail_sites(CH_diff_f_t_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_f_t_N, site)
    endif

    if(avail_sites(CH_f_dis, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_f_dis, site)
    endif

    if(avail_sites(H_CH_f_react_s_E, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CH_f_react_s_E, site)
    endif

    if(avail_sites(H_CH_f_react_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CH_f_react_t, site)
    endif

    if(avail_sites(H_CH_f_react_t_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CH_f_react_t_N, site)
    endif

    ! enable affected processes
    select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_f/)))
    case(C)
        call add_proc(C_diff_s_E_f, site)
    case(CH2)
        call add_proc(CH2_s_E_dis_f, site)
    case(CO)
        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(H_CO_s_react_t_NW, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(H_CO_s_react_t_W, site)
        end select

    case(CH)
        call add_proc(CH_diff_s_E_f, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
    case(C)
        call add_proc(C_diff_t_N_f, site)
    case(CH2)
        call add_proc(CH2_t_N_dis_f, site)
    case(CO)
        call add_proc(H_CO_t_react_f_S, site)
    case(CH)
        call add_proc(CH_diff_t_N_f, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
    case(C)
        call add_proc(C_diff_t_f, site)
    case(CH2)
        call add_proc(CH2_t_dis_f, site)
    case(CO)
        call add_proc(H_CO_t_react_f, site)
    case(CH)
        call add_proc(CH_diff_t_f, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(C)
        call add_proc(C_diff_f_S_f, site + (/0, -1, 0, 0/))
    case(CH)
        call add_proc(CH_diff_f_S_f, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(C)
        call add_proc(C_diff_f_f_S, site)
    case(CH)
        call add_proc(CH_diff_f_f_S, site)
    end select


end subroutine take_CH_Rh211_f

subroutine put_CH2_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, CH2)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_s_N_s, site)
    endif

    if(avail_sites(CH2_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_N_s, site)
    endif

    if(avail_sites(CH2_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_s, site)
    endif

    if(avail_sites(CH3_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_s_N_s, site)
    endif

    if(avail_sites(CH3_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_N_s, site)
    endif

    if(avail_sites(CH3_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_s, site)
    endif

    if(avail_sites(CH4_s_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH4_s_ads, site)
    endif

    if(avail_sites(CH_diff_f_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(CH_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(CH_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_N_s, site)
    endif

    if(avail_sites(CH_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_N_s, site)
    endif

    if(avail_sites(CH_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_s, site)
    endif

    if(avail_sites(CO_ads_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_ads_s, site)
    endif

    if(avail_sites(CO_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_s_N_s, site)
    endif

    if(avail_sites(CO_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_N_s, site)
    endif

    if(avail_sites(CO_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_s, site)
    endif

    if(avail_sites(C_OH_s_react_t_NW, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_OH_s_react_t_W, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_f_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_N_s, site)
    endif

    if(avail_sites(C_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_N_s, site)
    endif

    if(avail_sites(C_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_s, site)
    endif

    if(avail_sites(H2O_O_s_react_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_s_react_s_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_S, site)
    endif

    if(avail_sites(H2O_O_t_N_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_N_react_s, site)
    endif

    if(avail_sites(H2O_O_t_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_s, site)
    endif

    if(avail_sites(H2O_s_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_s_ads, site)
    endif

    if(avail_sites(H_CH_f_react_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(H_CH_f_react_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(OH_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_s_N_s, site)
    endif

    if(avail_sites(OH_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_N_s, site)
    endif

    if(avail_sites(OH_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_s, site)
    endif

    if(avail_sites(O_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_s_N_s, site)
    endif

    if(avail_sites(O_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_N_s, site)
    endif

    if(avail_sites(O_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_s, site)
    endif

    ! enable affected processes
    call add_proc(CH2_s_dis, site)
    call add_proc(H_CH2_s_react, site)
    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(CH2_diff_s_N_s, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(CH2_diff_s_s_N, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
    case(empty)
        call add_proc(CH2_diff_s_t, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
    case(empty)
        call add_proc(CH2_diff_s_t_N, site)
    end select

    select case(get_species(site + (/-1, 0, 0, Rh211_f - Rh211_s/)))
    case(empty)
        call add_proc(CH2_s_E_dis_f, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    end select


end subroutine put_CH2_Rh211_s

subroutine take_CH2_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, CH2, empty)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_N_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_s_N_s, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_s_s_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_s_s_N, site)
    endif

    if(avail_sites(CH2_diff_s_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_s_t, site)
    endif

    if(avail_sites(CH2_diff_s_t_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_s_t_N, site)
    endif

    if(avail_sites(CH2_s_E_dis_f, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(CH2_s_E_dis_f, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(CH2_s_dis, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_s_dis, site)
    endif

    if(avail_sites(H_CH2_s_react, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CH2_s_react, site)
    endif

    ! enable affected processes
    call add_proc(CH4_s_ads, site)
    call add_proc(CO_ads_s, site)
    call add_proc(H2O_s_ads, site)
    select case(get_species(site + (/0, 1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_s_N_s, site)
    case(C)
        call add_proc(C_diff_s_N_s, site)
    case(CH3)
        call add_proc(CH3_diff_s_N_s, site)
    case(O)
        call add_proc(H2O_O_s_react_s_S, site)
        call add_proc(O_diff_s_N_s, site)
    case(CH2)
        call add_proc(CH2_diff_s_N_s, site)
    case(CO)
        call add_proc(CO_diff_s_N_s, site)
    case(OH)
        call add_proc(OH_diff_s_N_s, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(C)
        call add_proc(C_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CH3)
        call add_proc(CH3_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(O)
        call add_proc(H2O_O_s_react_s_N, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CH2)
        call add_proc(CH2_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CO)
        call add_proc(CO_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_diff_s_s_N, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
    case(CH)
        call add_proc(CH_diff_t_N_s, site)
    case(C)
        call add_proc(C_diff_t_N_s, site)
    case(CH3)
        call add_proc(CH3_diff_t_N_s, site)
    case(O)
        call add_proc(H2O_O_t_N_react_s, site)
        call add_proc(O_diff_t_N_s, site)
    case(CH2)
        call add_proc(CH2_diff_t_N_s, site)
    case(CO)
        call add_proc(CO_diff_t_N_s, site)
    case(OH)
        call add_proc(OH_diff_t_N_s, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
    case(CH)
        call add_proc(CH_diff_t_s, site)
    case(C)
        call add_proc(C_diff_t_s, site)
    case(CH3)
        call add_proc(CH3_diff_t_s, site)
    case(O)
        call add_proc(H2O_O_t_react_s, site)
        call add_proc(O_diff_t_s, site)
    case(CH2)
        call add_proc(CH2_diff_t_s, site)
    case(CO)
        call add_proc(CO_diff_t_s, site)
    case(OH)
        call add_proc(OH_diff_t_s, site)
    end select

    select case(get_species(site + (/-1, 0, 0, Rh211_f - Rh211_s/)))
    case(C)
        call add_proc(C_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        select case(get_species(site + (/-1, 1, 0, Rh211_t - Rh211_s/)))
        case(OH)
            call add_proc(C_OH_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

        select case(get_species(site + (/-1, 0, 0, Rh211_t - Rh211_s/)))
        case(OH)
            call add_proc(C_OH_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

    case(CH)
        call add_proc(CH_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        call add_proc(H_CH_f_react_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    end select


end subroutine take_CH2_Rh211_s

subroutine put_CH2_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, CH2)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_t_S, site)
    endif

    if(avail_sites(CH3_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_t_S, site)
    endif

    if(avail_sites(CH4_t_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH4_t_ads, site)
    endif

    if(avail_sites(CH_diff_f_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_f_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_t_S, site)
    endif

    if(avail_sites(CO_ads_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_ads_t, site)
    endif

    if(avail_sites(CO_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_t_S, site)
    endif

    if(avail_sites(C_diff_f_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_f_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_t_S, site)
    endif

    if(avail_sites(H2O_O_s_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_s_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_t_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_t_react_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_S, site)
    endif

    if(avail_sites(H2O_t_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_t_ads, site)
    endif

    if(avail_sites(H_CH_f_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CH_f_react_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CH_f_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CH_f_react_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(OH_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_t_S, site)
    endif

    if(avail_sites(O_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_t_S, site)
    endif

    ! enable affected processes
    call add_proc(CH2_t_dis, site)
    call add_proc(H_CH2_t_react, site)
    select case(get_species(site + (/0, -1, 0, Rh211_s - Rh211_t/)))
    case(empty)
        call add_proc(CH2_diff_t_N_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(CH2_diff_t_S_t, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_s - Rh211_t/)))
    case(empty)
        call add_proc(CH2_diff_t_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(CH2_diff_t_t_S, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_f - Rh211_t/)))
    case(empty)
        call add_proc(CH2_t_N_dis_f, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_f - Rh211_t/)))
    case(empty)
        call add_proc(CH2_t_dis_f, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    end select


end subroutine put_CH2_Rh211_t

subroutine take_CH2_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, CH2, empty)

    ! disable affected processes
    if(avail_sites(CH2_diff_t_N_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_t_N_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_t_S_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_S_t, site)
    endif

    if(avail_sites(CH2_diff_t_s, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_t_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_t_t_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_t_t_S, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_t_N_dis_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_t_N_dis_f, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH2_t_dis, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_dis, site)
    endif

    if(avail_sites(CH2_t_dis_f, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_t_dis_f, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CH2_t_react, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CH2_t_react, site)
    endif

    ! enable affected processes
    call add_proc(CH4_t_ads, site)
    call add_proc(CO_ads_t, site)
    call add_proc(H2O_t_ads, site)
    select case(get_species(site + (/0, 0, 0, Rh211_s - Rh211_t/)))
    case(CH)
        call add_proc(CH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(C)
        call add_proc(C_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CH3)
        call add_proc(CH3_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(O)
        call add_proc(H2O_O_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CH2)
        call add_proc(CH2_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CO)
        call add_proc(CO_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_s - Rh211_t/)))
    case(CH)
        call add_proc(CH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(C)
        call add_proc(C_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CH3)
        call add_proc(CH3_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(O)
        call add_proc(H2O_O_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CH2)
        call add_proc(CH2_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CO)
        call add_proc(CO_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(C)
        call add_proc(C_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CH3)
        call add_proc(CH3_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(O)
        call add_proc(H2O_O_t_react_t_N, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CH2)
        call add_proc(CH2_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CO)
        call add_proc(CO_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_diff_t_S_t, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_t_t_S, site)
    case(C)
        call add_proc(C_diff_t_t_S, site)
    case(CH3)
        call add_proc(CH3_diff_t_t_S, site)
    case(O)
        call add_proc(H2O_O_t_react_t_S, site)
        call add_proc(O_diff_t_t_S, site)
    case(CH2)
        call add_proc(CH2_diff_t_t_S, site)
    case(CO)
        call add_proc(CO_diff_t_t_S, site)
    case(OH)
        call add_proc(OH_diff_t_t_S, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    case(empty)
        select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_t/)))
        case(CO)
            call add_proc(H_CO_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        end select

    case(CH)
        call add_proc(CH_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        call add_proc(H_CH_f_react_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    case(empty)
        select case(get_species(site + (/1, -1, 0, Rh211_s - Rh211_t/)))
        case(CO)
            call add_proc(H_CO_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        end select

    case(CH)
        call add_proc(CH_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        call add_proc(H_CH_f_react_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    end select


end subroutine take_CH2_Rh211_t

subroutine put_CH2_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, CH2)

    ! disable affected processes
    if(avail_sites(CH2_s_E_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_s_E_dis_f, site)
    endif

    if(avail_sites(CH2_t_N_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_N_dis_f, site)
    endif

    if(avail_sites(CH2_t_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_dis_f, site)
    endif

    if(avail_sites(CH_diff_f_S_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_f_S_f, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_f_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_f_f_S, site)
    endif

    if(avail_sites(CH_diff_s_E_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_E_f, site)
    endif

    if(avail_sites(CH_diff_t_N_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_N_f, site)
    endif

    if(avail_sites(CH_diff_t_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_f, site)
    endif

    if(avail_sites(C_diff_f_S_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_f_S_f, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_f_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_f_f_S, site)
    endif

    if(avail_sites(C_diff_s_E_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_E_f, site)
    endif

    if(avail_sites(C_diff_t_N_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_N_f, site)
    endif

    if(avail_sites(C_diff_t_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_f, site)
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site)
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site)
    endif

    if(avail_sites(H_CO_t_react_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_t_react_f, site)
    endif

    if(avail_sites(H_CO_t_react_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_t_react_f_S, site)
    endif


end subroutine put_CH2_Rh211_f

subroutine take_CH2_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, CH2, empty)

    ! enable affected processes
    select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_f/)))
    case(C)
        call add_proc(C_diff_s_E_f, site)
    case(CH2)
        call add_proc(CH2_s_E_dis_f, site)
    case(CO)
        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(H_CO_s_react_t_NW, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(H_CO_s_react_t_W, site)
        end select

    case(CH)
        call add_proc(CH_diff_s_E_f, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
    case(C)
        call add_proc(C_diff_t_N_f, site)
    case(CH2)
        call add_proc(CH2_t_N_dis_f, site)
    case(CO)
        call add_proc(H_CO_t_react_f_S, site)
    case(CH)
        call add_proc(CH_diff_t_N_f, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
    case(C)
        call add_proc(C_diff_t_f, site)
    case(CH2)
        call add_proc(CH2_t_dis_f, site)
    case(CO)
        call add_proc(H_CO_t_react_f, site)
    case(CH)
        call add_proc(CH_diff_t_f, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(C)
        call add_proc(C_diff_f_S_f, site + (/0, -1, 0, 0/))
    case(CH)
        call add_proc(CH_diff_f_S_f, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(C)
        call add_proc(C_diff_f_f_S, site)
    case(CH)
        call add_proc(CH_diff_f_f_S, site)
    end select


end subroutine take_CH2_Rh211_f

subroutine put_CH3_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, CH3)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_s_N_s, site)
    endif

    if(avail_sites(CH2_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_N_s, site)
    endif

    if(avail_sites(CH2_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_s, site)
    endif

    if(avail_sites(CH3_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_s_N_s, site)
    endif

    if(avail_sites(CH3_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_N_s, site)
    endif

    if(avail_sites(CH3_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_s, site)
    endif

    if(avail_sites(CH4_s_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH4_s_ads, site)
    endif

    if(avail_sites(CH_diff_f_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(CH_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(CH_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_N_s, site)
    endif

    if(avail_sites(CH_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_N_s, site)
    endif

    if(avail_sites(CH_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_s, site)
    endif

    if(avail_sites(CO_ads_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_ads_s, site)
    endif

    if(avail_sites(CO_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_s_N_s, site)
    endif

    if(avail_sites(CO_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_N_s, site)
    endif

    if(avail_sites(CO_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_s, site)
    endif

    if(avail_sites(C_OH_s_react_t_NW, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_OH_s_react_t_W, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_f_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_N_s, site)
    endif

    if(avail_sites(C_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_N_s, site)
    endif

    if(avail_sites(C_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_s, site)
    endif

    if(avail_sites(H2O_O_s_react_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_s_react_s_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_S, site)
    endif

    if(avail_sites(H2O_O_t_N_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_N_react_s, site)
    endif

    if(avail_sites(H2O_O_t_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_s, site)
    endif

    if(avail_sites(H2O_s_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_s_ads, site)
    endif

    if(avail_sites(H_CH_f_react_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(H_CH_f_react_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(OH_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_s_N_s, site)
    endif

    if(avail_sites(OH_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_N_s, site)
    endif

    if(avail_sites(OH_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_s, site)
    endif

    if(avail_sites(O_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_s_N_s, site)
    endif

    if(avail_sites(O_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_N_s, site)
    endif

    if(avail_sites(O_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_s, site)
    endif

    ! enable affected processes
    call add_proc(CH3_s_dis, site)
    call add_proc(H_CH3_s_react, site)
    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(CH3_diff_s_N_s, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(CH3_diff_s_s_N, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
    case(empty)
        call add_proc(CH3_diff_s_t, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
    case(empty)
        call add_proc(CH3_diff_s_t_N, site)
    end select


end subroutine put_CH3_Rh211_s

subroutine take_CH3_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, CH3, empty)

    ! disable affected processes
    if(avail_sites(CH3_diff_s_N_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_s_N_s, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_s_s_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_s_s_N, site)
    endif

    if(avail_sites(CH3_diff_s_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_s_t, site)
    endif

    if(avail_sites(CH3_diff_s_t_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_s_t_N, site)
    endif

    if(avail_sites(CH3_s_dis, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_s_dis, site)
    endif

    if(avail_sites(H_CH3_s_react, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CH3_s_react, site)
    endif

    ! enable affected processes
    call add_proc(CH4_s_ads, site)
    call add_proc(CO_ads_s, site)
    call add_proc(H2O_s_ads, site)
    select case(get_species(site + (/0, 1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_s_N_s, site)
    case(C)
        call add_proc(C_diff_s_N_s, site)
    case(CH3)
        call add_proc(CH3_diff_s_N_s, site)
    case(O)
        call add_proc(H2O_O_s_react_s_S, site)
        call add_proc(O_diff_s_N_s, site)
    case(CH2)
        call add_proc(CH2_diff_s_N_s, site)
    case(CO)
        call add_proc(CO_diff_s_N_s, site)
    case(OH)
        call add_proc(OH_diff_s_N_s, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(C)
        call add_proc(C_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CH3)
        call add_proc(CH3_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(O)
        call add_proc(H2O_O_s_react_s_N, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CH2)
        call add_proc(CH2_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CO)
        call add_proc(CO_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_diff_s_s_N, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
    case(CH)
        call add_proc(CH_diff_t_N_s, site)
    case(C)
        call add_proc(C_diff_t_N_s, site)
    case(CH3)
        call add_proc(CH3_diff_t_N_s, site)
    case(O)
        call add_proc(H2O_O_t_N_react_s, site)
        call add_proc(O_diff_t_N_s, site)
    case(CH2)
        call add_proc(CH2_diff_t_N_s, site)
    case(CO)
        call add_proc(CO_diff_t_N_s, site)
    case(OH)
        call add_proc(OH_diff_t_N_s, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
    case(CH)
        call add_proc(CH_diff_t_s, site)
    case(C)
        call add_proc(C_diff_t_s, site)
    case(CH3)
        call add_proc(CH3_diff_t_s, site)
    case(O)
        call add_proc(H2O_O_t_react_s, site)
        call add_proc(O_diff_t_s, site)
    case(CH2)
        call add_proc(CH2_diff_t_s, site)
    case(CO)
        call add_proc(CO_diff_t_s, site)
    case(OH)
        call add_proc(OH_diff_t_s, site)
    end select

    select case(get_species(site + (/-1, 0, 0, Rh211_f - Rh211_s/)))
    case(C)
        call add_proc(C_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        select case(get_species(site + (/-1, 1, 0, Rh211_t - Rh211_s/)))
        case(OH)
            call add_proc(C_OH_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

        select case(get_species(site + (/-1, 0, 0, Rh211_t - Rh211_s/)))
        case(OH)
            call add_proc(C_OH_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

    case(CH)
        call add_proc(CH_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        call add_proc(H_CH_f_react_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    end select


end subroutine take_CH3_Rh211_s

subroutine put_CH3_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, CH3)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_t_S, site)
    endif

    if(avail_sites(CH3_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_t_S, site)
    endif

    if(avail_sites(CH4_t_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH4_t_ads, site)
    endif

    if(avail_sites(CH_diff_f_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_f_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_t_S, site)
    endif

    if(avail_sites(CO_ads_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_ads_t, site)
    endif

    if(avail_sites(CO_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_t_S, site)
    endif

    if(avail_sites(C_diff_f_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_f_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_t_S, site)
    endif

    if(avail_sites(H2O_O_s_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_s_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_t_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_t_react_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_S, site)
    endif

    if(avail_sites(H2O_t_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_t_ads, site)
    endif

    if(avail_sites(H_CH_f_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CH_f_react_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CH_f_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CH_f_react_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(OH_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_t_S, site)
    endif

    if(avail_sites(O_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_t_S, site)
    endif

    ! enable affected processes
    call add_proc(CH3_t_dis, site)
    call add_proc(H_CH3_t_react, site)
    select case(get_species(site + (/0, -1, 0, Rh211_s - Rh211_t/)))
    case(empty)
        call add_proc(CH3_diff_t_N_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(CH3_diff_t_S_t, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_s - Rh211_t/)))
    case(empty)
        call add_proc(CH3_diff_t_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(CH3_diff_t_t_S, site + (/0, -1, 0, 0/))
    end select


end subroutine put_CH3_Rh211_t

subroutine take_CH3_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, CH3, empty)

    ! disable affected processes
    if(avail_sites(CH3_diff_t_N_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_t_N_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_t_S_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_S_t, site)
    endif

    if(avail_sites(CH3_diff_t_s, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_t_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_t_t_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_t_t_S, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_t_dis, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_t_dis, site)
    endif

    if(avail_sites(H_CH3_t_react, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CH3_t_react, site)
    endif

    ! enable affected processes
    call add_proc(CH4_t_ads, site)
    call add_proc(CO_ads_t, site)
    call add_proc(H2O_t_ads, site)
    select case(get_species(site + (/0, 0, 0, Rh211_s - Rh211_t/)))
    case(CH)
        call add_proc(CH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(C)
        call add_proc(C_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CH3)
        call add_proc(CH3_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(O)
        call add_proc(H2O_O_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CH2)
        call add_proc(CH2_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CO)
        call add_proc(CO_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_s - Rh211_t/)))
    case(CH)
        call add_proc(CH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(C)
        call add_proc(C_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CH3)
        call add_proc(CH3_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(O)
        call add_proc(H2O_O_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CH2)
        call add_proc(CH2_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CO)
        call add_proc(CO_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(C)
        call add_proc(C_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CH3)
        call add_proc(CH3_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(O)
        call add_proc(H2O_O_t_react_t_N, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CH2)
        call add_proc(CH2_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CO)
        call add_proc(CO_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_diff_t_S_t, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_t_t_S, site)
    case(C)
        call add_proc(C_diff_t_t_S, site)
    case(CH3)
        call add_proc(CH3_diff_t_t_S, site)
    case(O)
        call add_proc(H2O_O_t_react_t_S, site)
        call add_proc(O_diff_t_t_S, site)
    case(CH2)
        call add_proc(CH2_diff_t_t_S, site)
    case(CO)
        call add_proc(CO_diff_t_t_S, site)
    case(OH)
        call add_proc(OH_diff_t_t_S, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    case(empty)
        select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_t/)))
        case(CO)
            call add_proc(H_CO_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        end select

    case(CH)
        call add_proc(CH_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        call add_proc(H_CH_f_react_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    case(empty)
        select case(get_species(site + (/1, -1, 0, Rh211_s - Rh211_t/)))
        case(CO)
            call add_proc(H_CO_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        end select

    case(CH)
        call add_proc(CH_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        call add_proc(H_CH_f_react_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    end select


end subroutine take_CH3_Rh211_t

subroutine put_CH3_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, CH3)

    ! disable affected processes
    if(avail_sites(CH2_s_E_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_s_E_dis_f, site)
    endif

    if(avail_sites(CH2_t_N_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_N_dis_f, site)
    endif

    if(avail_sites(CH2_t_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_dis_f, site)
    endif

    if(avail_sites(CH_diff_f_S_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_f_S_f, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_f_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_f_f_S, site)
    endif

    if(avail_sites(CH_diff_s_E_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_E_f, site)
    endif

    if(avail_sites(CH_diff_t_N_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_N_f, site)
    endif

    if(avail_sites(CH_diff_t_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_f, site)
    endif

    if(avail_sites(C_diff_f_S_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_f_S_f, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_f_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_f_f_S, site)
    endif

    if(avail_sites(C_diff_s_E_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_E_f, site)
    endif

    if(avail_sites(C_diff_t_N_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_N_f, site)
    endif

    if(avail_sites(C_diff_t_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_f, site)
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site)
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site)
    endif

    if(avail_sites(H_CO_t_react_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_t_react_f, site)
    endif

    if(avail_sites(H_CO_t_react_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_t_react_f_S, site)
    endif


end subroutine put_CH3_Rh211_f

subroutine take_CH3_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, CH3, empty)

    ! enable affected processes
    select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_f/)))
    case(C)
        call add_proc(C_diff_s_E_f, site)
    case(CH2)
        call add_proc(CH2_s_E_dis_f, site)
    case(CO)
        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(H_CO_s_react_t_NW, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(H_CO_s_react_t_W, site)
        end select

    case(CH)
        call add_proc(CH_diff_s_E_f, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
    case(C)
        call add_proc(C_diff_t_N_f, site)
    case(CH2)
        call add_proc(CH2_t_N_dis_f, site)
    case(CO)
        call add_proc(H_CO_t_react_f_S, site)
    case(CH)
        call add_proc(CH_diff_t_N_f, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
    case(C)
        call add_proc(C_diff_t_f, site)
    case(CH2)
        call add_proc(CH2_t_dis_f, site)
    case(CO)
        call add_proc(H_CO_t_react_f, site)
    case(CH)
        call add_proc(CH_diff_t_f, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(C)
        call add_proc(C_diff_f_S_f, site + (/0, -1, 0, 0/))
    case(CH)
        call add_proc(CH_diff_f_S_f, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(C)
        call add_proc(C_diff_f_f_S, site)
    case(CH)
        call add_proc(CH_diff_f_f_S, site)
    end select


end subroutine take_CH3_Rh211_f

subroutine put_CO_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, CO)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_s_N_s, site)
    endif

    if(avail_sites(CH2_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_N_s, site)
    endif

    if(avail_sites(CH2_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_s, site)
    endif

    if(avail_sites(CH3_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_s_N_s, site)
    endif

    if(avail_sites(CH3_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_N_s, site)
    endif

    if(avail_sites(CH3_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_s, site)
    endif

    if(avail_sites(CH4_s_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH4_s_ads, site)
    endif

    if(avail_sites(CH_diff_f_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(CH_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(CH_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_N_s, site)
    endif

    if(avail_sites(CH_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_N_s, site)
    endif

    if(avail_sites(CH_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_s, site)
    endif

    if(avail_sites(CO_ads_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_ads_s, site)
    endif

    if(avail_sites(CO_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_s_N_s, site)
    endif

    if(avail_sites(CO_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_N_s, site)
    endif

    if(avail_sites(CO_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_s, site)
    endif

    if(avail_sites(C_OH_s_react_t_NW, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_OH_s_react_t_W, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_f_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_N_s, site)
    endif

    if(avail_sites(C_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_N_s, site)
    endif

    if(avail_sites(C_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_s, site)
    endif

    if(avail_sites(H2O_O_s_react_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_s_react_s_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_S, site)
    endif

    if(avail_sites(H2O_O_t_N_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_N_react_s, site)
    endif

    if(avail_sites(H2O_O_t_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_s, site)
    endif

    if(avail_sites(H2O_s_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_s_ads, site)
    endif

    if(avail_sites(H_CH_f_react_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(H_CH_f_react_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(OH_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_s_N_s, site)
    endif

    if(avail_sites(OH_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_N_s, site)
    endif

    if(avail_sites(OH_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_s, site)
    endif

    if(avail_sites(O_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_s_N_s, site)
    endif

    if(avail_sites(O_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_N_s, site)
    endif

    if(avail_sites(O_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_s, site)
    endif

    ! enable affected processes
    call add_proc(CO_des_s, site)
    select case(get_species(site + (/-1, 0, 0, Rh211_f - Rh211_s/)))
    case(empty)
        select case(get_species(site + (/-1, 1, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(H_CO_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

        select case(get_species(site + (/-1, 0, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(H_CO_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(CO_diff_s_N_s, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(CO_diff_s_s_N, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
    case(empty)
        call add_proc(CO_diff_s_t, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
    case(empty)
        call add_proc(CO_diff_s_t_N, site)
    end select


end subroutine put_CO_Rh211_s

subroutine take_CO_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, CO, empty)

    ! disable affected processes
    if(avail_sites(CO_des_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_des_s, site)
    endif

    if(avail_sites(CO_diff_s_N_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_s_N_s, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_s_s_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_s_s_N, site)
    endif

    if(avail_sites(CO_diff_s_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_s_t, site)
    endif

    if(avail_sites(CO_diff_s_t_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_s_t_N, site)
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    ! enable affected processes
    call add_proc(CH4_s_ads, site)
    call add_proc(CO_ads_s, site)
    call add_proc(H2O_s_ads, site)
    select case(get_species(site + (/0, 1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_s_N_s, site)
    case(C)
        call add_proc(C_diff_s_N_s, site)
    case(CH3)
        call add_proc(CH3_diff_s_N_s, site)
    case(O)
        call add_proc(H2O_O_s_react_s_S, site)
        call add_proc(O_diff_s_N_s, site)
    case(CH2)
        call add_proc(CH2_diff_s_N_s, site)
    case(CO)
        call add_proc(CO_diff_s_N_s, site)
    case(OH)
        call add_proc(OH_diff_s_N_s, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(C)
        call add_proc(C_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CH3)
        call add_proc(CH3_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(O)
        call add_proc(H2O_O_s_react_s_N, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CH2)
        call add_proc(CH2_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CO)
        call add_proc(CO_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_diff_s_s_N, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
    case(CH)
        call add_proc(CH_diff_t_N_s, site)
    case(C)
        call add_proc(C_diff_t_N_s, site)
    case(CH3)
        call add_proc(CH3_diff_t_N_s, site)
    case(O)
        call add_proc(H2O_O_t_N_react_s, site)
        call add_proc(O_diff_t_N_s, site)
    case(CH2)
        call add_proc(CH2_diff_t_N_s, site)
    case(CO)
        call add_proc(CO_diff_t_N_s, site)
    case(OH)
        call add_proc(OH_diff_t_N_s, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
    case(CH)
        call add_proc(CH_diff_t_s, site)
    case(C)
        call add_proc(C_diff_t_s, site)
    case(CH3)
        call add_proc(CH3_diff_t_s, site)
    case(O)
        call add_proc(H2O_O_t_react_s, site)
        call add_proc(O_diff_t_s, site)
    case(CH2)
        call add_proc(CH2_diff_t_s, site)
    case(CO)
        call add_proc(CO_diff_t_s, site)
    case(OH)
        call add_proc(OH_diff_t_s, site)
    end select

    select case(get_species(site + (/-1, 0, 0, Rh211_f - Rh211_s/)))
    case(C)
        call add_proc(C_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        select case(get_species(site + (/-1, 1, 0, Rh211_t - Rh211_s/)))
        case(OH)
            call add_proc(C_OH_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

        select case(get_species(site + (/-1, 0, 0, Rh211_t - Rh211_s/)))
        case(OH)
            call add_proc(C_OH_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

    case(CH)
        call add_proc(CH_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        call add_proc(H_CH_f_react_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    end select


end subroutine take_CO_Rh211_s

subroutine put_CO_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, CO)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_t_S, site)
    endif

    if(avail_sites(CH3_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_t_S, site)
    endif

    if(avail_sites(CH4_t_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH4_t_ads, site)
    endif

    if(avail_sites(CH_diff_f_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_f_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_t_S, site)
    endif

    if(avail_sites(CO_ads_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_ads_t, site)
    endif

    if(avail_sites(CO_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_t_S, site)
    endif

    if(avail_sites(C_diff_f_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_f_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_t_S, site)
    endif

    if(avail_sites(H2O_O_s_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_s_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_t_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_t_react_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_S, site)
    endif

    if(avail_sites(H2O_t_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_t_ads, site)
    endif

    if(avail_sites(H_CH_f_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CH_f_react_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CH_f_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CH_f_react_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(OH_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_t_S, site)
    endif

    if(avail_sites(O_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_t_S, site)
    endif

    ! enable affected processes
    call add_proc(CO_des_t, site)
    select case(get_species(site + (/0, -1, 0, Rh211_s - Rh211_t/)))
    case(empty)
        call add_proc(CO_diff_t_N_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(CO_diff_t_S_t, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_s - Rh211_t/)))
    case(empty)
        call add_proc(CO_diff_t_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(CO_diff_t_t_S, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_f - Rh211_t/)))
    case(empty)
        call add_proc(H_CO_t_react_f, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_f - Rh211_t/)))
    case(empty)
        call add_proc(H_CO_t_react_f_S, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    end select


end subroutine put_CO_Rh211_t

subroutine take_CO_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, CO, empty)

    ! disable affected processes
    if(avail_sites(CO_des_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_des_t, site)
    endif

    if(avail_sites(CO_diff_t_N_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_t_N_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_t_S_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_S_t, site)
    endif

    if(avail_sites(CO_diff_t_s, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_t_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_t_t_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_t_t_S, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H_CO_t_react_f, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_t_react_f, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_t_react_f_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_t_react_f_S, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    ! enable affected processes
    call add_proc(CH4_t_ads, site)
    call add_proc(CO_ads_t, site)
    call add_proc(H2O_t_ads, site)
    select case(get_species(site + (/0, 0, 0, Rh211_s - Rh211_t/)))
    case(CH)
        call add_proc(CH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(C)
        call add_proc(C_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CH3)
        call add_proc(CH3_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(O)
        call add_proc(H2O_O_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CH2)
        call add_proc(CH2_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CO)
        call add_proc(CO_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_s - Rh211_t/)))
    case(CH)
        call add_proc(CH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(C)
        call add_proc(C_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CH3)
        call add_proc(CH3_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(O)
        call add_proc(H2O_O_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CH2)
        call add_proc(CH2_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CO)
        call add_proc(CO_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(C)
        call add_proc(C_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CH3)
        call add_proc(CH3_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(O)
        call add_proc(H2O_O_t_react_t_N, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CH2)
        call add_proc(CH2_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CO)
        call add_proc(CO_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_diff_t_S_t, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_t_t_S, site)
    case(C)
        call add_proc(C_diff_t_t_S, site)
    case(CH3)
        call add_proc(CH3_diff_t_t_S, site)
    case(O)
        call add_proc(H2O_O_t_react_t_S, site)
        call add_proc(O_diff_t_t_S, site)
    case(CH2)
        call add_proc(CH2_diff_t_t_S, site)
    case(CO)
        call add_proc(CO_diff_t_t_S, site)
    case(OH)
        call add_proc(OH_diff_t_t_S, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    case(empty)
        select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_t/)))
        case(CO)
            call add_proc(H_CO_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        end select

    case(CH)
        call add_proc(CH_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        call add_proc(H_CH_f_react_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    case(empty)
        select case(get_species(site + (/1, -1, 0, Rh211_s - Rh211_t/)))
        case(CO)
            call add_proc(H_CO_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        end select

    case(CH)
        call add_proc(CH_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        call add_proc(H_CH_f_react_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    end select


end subroutine take_CO_Rh211_t

subroutine put_CO_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, CO)

    ! disable affected processes
    if(avail_sites(CH2_s_E_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_s_E_dis_f, site)
    endif

    if(avail_sites(CH2_t_N_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_N_dis_f, site)
    endif

    if(avail_sites(CH2_t_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_dis_f, site)
    endif

    if(avail_sites(CH_diff_f_S_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_f_S_f, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_f_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_f_f_S, site)
    endif

    if(avail_sites(CH_diff_s_E_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_E_f, site)
    endif

    if(avail_sites(CH_diff_t_N_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_N_f, site)
    endif

    if(avail_sites(CH_diff_t_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_f, site)
    endif

    if(avail_sites(C_diff_f_S_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_f_S_f, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_f_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_f_f_S, site)
    endif

    if(avail_sites(C_diff_s_E_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_E_f, site)
    endif

    if(avail_sites(C_diff_t_N_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_N_f, site)
    endif

    if(avail_sites(C_diff_t_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_f, site)
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site)
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site)
    endif

    if(avail_sites(H_CO_t_react_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_t_react_f, site)
    endif

    if(avail_sites(H_CO_t_react_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_t_react_f_S, site)
    endif


end subroutine put_CO_Rh211_f

subroutine take_CO_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, CO, empty)

    ! enable affected processes
    select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_f/)))
    case(C)
        call add_proc(C_diff_s_E_f, site)
    case(CH2)
        call add_proc(CH2_s_E_dis_f, site)
    case(CO)
        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(H_CO_s_react_t_NW, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(H_CO_s_react_t_W, site)
        end select

    case(CH)
        call add_proc(CH_diff_s_E_f, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
    case(C)
        call add_proc(C_diff_t_N_f, site)
    case(CH2)
        call add_proc(CH2_t_N_dis_f, site)
    case(CO)
        call add_proc(H_CO_t_react_f_S, site)
    case(CH)
        call add_proc(CH_diff_t_N_f, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
    case(C)
        call add_proc(C_diff_t_f, site)
    case(CH2)
        call add_proc(CH2_t_dis_f, site)
    case(CO)
        call add_proc(H_CO_t_react_f, site)
    case(CH)
        call add_proc(CH_diff_t_f, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(C)
        call add_proc(C_diff_f_S_f, site + (/0, -1, 0, 0/))
    case(CH)
        call add_proc(CH_diff_f_S_f, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(C)
        call add_proc(C_diff_f_f_S, site)
    case(CH)
        call add_proc(CH_diff_f_f_S, site)
    end select


end subroutine take_CO_Rh211_f

subroutine put_O_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, O)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_s_N_s, site)
    endif

    if(avail_sites(CH2_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_N_s, site)
    endif

    if(avail_sites(CH2_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_s, site)
    endif

    if(avail_sites(CH3_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_s_N_s, site)
    endif

    if(avail_sites(CH3_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_N_s, site)
    endif

    if(avail_sites(CH3_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_s, site)
    endif

    if(avail_sites(CH4_s_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH4_s_ads, site)
    endif

    if(avail_sites(CH_diff_f_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(CH_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(CH_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_N_s, site)
    endif

    if(avail_sites(CH_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_N_s, site)
    endif

    if(avail_sites(CH_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_s, site)
    endif

    if(avail_sites(CO_ads_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_ads_s, site)
    endif

    if(avail_sites(CO_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_s_N_s, site)
    endif

    if(avail_sites(CO_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_N_s, site)
    endif

    if(avail_sites(CO_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_s, site)
    endif

    if(avail_sites(C_OH_s_react_t_NW, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_OH_s_react_t_W, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_f_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_N_s, site)
    endif

    if(avail_sites(C_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_N_s, site)
    endif

    if(avail_sites(C_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_s, site)
    endif

    if(avail_sites(H2O_O_s_react_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_s_react_s_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_S, site)
    endif

    if(avail_sites(H2O_O_t_N_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_N_react_s, site)
    endif

    if(avail_sites(H2O_O_t_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_s, site)
    endif

    if(avail_sites(H2O_s_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_s_ads, site)
    endif

    if(avail_sites(H_CH_f_react_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(H_CH_f_react_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(OH_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_s_N_s, site)
    endif

    if(avail_sites(OH_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_N_s, site)
    endif

    if(avail_sites(OH_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_s, site)
    endif

    if(avail_sites(O_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_s_N_s, site)
    endif

    if(avail_sites(O_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_N_s, site)
    endif

    if(avail_sites(O_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_s, site)
    endif

    ! enable affected processes
    call add_proc(H_O_s_react, site)
    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(H2O_O_s_react_s_N, site)
        call add_proc(O_diff_s_s_N, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(H2O_O_s_react_s_S, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_s_N_s, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
    case(empty)
        call add_proc(H2O_O_s_react_t, site)
        call add_proc(O_diff_s_t, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
    case(empty)
        call add_proc(H2O_O_s_react_t_N, site)
        call add_proc(O_diff_s_t_N, site)
    end select


end subroutine put_O_Rh211_s

subroutine take_O_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, O, empty)

    ! disable affected processes
    if(avail_sites(H2O_O_s_react_s_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_N, site)
    endif

    if(avail_sites(H2O_O_s_react_s_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_S, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_s_react_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t, site)
    endif

    if(avail_sites(H2O_O_s_react_t_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t_N, site)
    endif

    if(avail_sites(H_O_s_react, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_O_s_react, site)
    endif

    if(avail_sites(O_diff_s_N_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_s_N_s, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_s_s_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_s_s_N, site)
    endif

    if(avail_sites(O_diff_s_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_s_t, site)
    endif

    if(avail_sites(O_diff_s_t_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_s_t_N, site)
    endif

    ! enable affected processes
    call add_proc(CH4_s_ads, site)
    call add_proc(CO_ads_s, site)
    call add_proc(H2O_s_ads, site)
    select case(get_species(site + (/0, 1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_s_N_s, site)
    case(C)
        call add_proc(C_diff_s_N_s, site)
    case(CH3)
        call add_proc(CH3_diff_s_N_s, site)
    case(O)
        call add_proc(H2O_O_s_react_s_S, site)
        call add_proc(O_diff_s_N_s, site)
    case(CH2)
        call add_proc(CH2_diff_s_N_s, site)
    case(CO)
        call add_proc(CO_diff_s_N_s, site)
    case(OH)
        call add_proc(OH_diff_s_N_s, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(C)
        call add_proc(C_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CH3)
        call add_proc(CH3_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(O)
        call add_proc(H2O_O_s_react_s_N, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CH2)
        call add_proc(CH2_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CO)
        call add_proc(CO_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_diff_s_s_N, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
    case(CH)
        call add_proc(CH_diff_t_N_s, site)
    case(C)
        call add_proc(C_diff_t_N_s, site)
    case(CH3)
        call add_proc(CH3_diff_t_N_s, site)
    case(O)
        call add_proc(H2O_O_t_N_react_s, site)
        call add_proc(O_diff_t_N_s, site)
    case(CH2)
        call add_proc(CH2_diff_t_N_s, site)
    case(CO)
        call add_proc(CO_diff_t_N_s, site)
    case(OH)
        call add_proc(OH_diff_t_N_s, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
    case(CH)
        call add_proc(CH_diff_t_s, site)
    case(C)
        call add_proc(C_diff_t_s, site)
    case(CH3)
        call add_proc(CH3_diff_t_s, site)
    case(O)
        call add_proc(H2O_O_t_react_s, site)
        call add_proc(O_diff_t_s, site)
    case(CH2)
        call add_proc(CH2_diff_t_s, site)
    case(CO)
        call add_proc(CO_diff_t_s, site)
    case(OH)
        call add_proc(OH_diff_t_s, site)
    end select

    select case(get_species(site + (/-1, 0, 0, Rh211_f - Rh211_s/)))
    case(C)
        call add_proc(C_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        select case(get_species(site + (/-1, 1, 0, Rh211_t - Rh211_s/)))
        case(OH)
            call add_proc(C_OH_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

        select case(get_species(site + (/-1, 0, 0, Rh211_t - Rh211_s/)))
        case(OH)
            call add_proc(C_OH_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

    case(CH)
        call add_proc(CH_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        call add_proc(H_CH_f_react_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    end select


end subroutine take_O_Rh211_s

subroutine put_O_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, O)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_t_S, site)
    endif

    if(avail_sites(CH3_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_t_S, site)
    endif

    if(avail_sites(CH4_t_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH4_t_ads, site)
    endif

    if(avail_sites(CH_diff_f_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_f_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_t_S, site)
    endif

    if(avail_sites(CO_ads_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_ads_t, site)
    endif

    if(avail_sites(CO_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_t_S, site)
    endif

    if(avail_sites(C_diff_f_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_f_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_t_S, site)
    endif

    if(avail_sites(H2O_O_s_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_s_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_t_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_t_react_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_S, site)
    endif

    if(avail_sites(H2O_t_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_t_ads, site)
    endif

    if(avail_sites(H_CH_f_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CH_f_react_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CH_f_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CH_f_react_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(OH_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_t_S, site)
    endif

    if(avail_sites(O_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_t_S, site)
    endif

    ! enable affected processes
    call add_proc(H_O_t_react, site)
    select case(get_species(site + (/0, -1, 0, Rh211_s - Rh211_t/)))
    case(empty)
        call add_proc(H2O_O_t_N_react_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_t_N_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_s - Rh211_t/)))
    case(empty)
        call add_proc(H2O_O_t_react_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_t_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(H2O_O_t_react_t_N, site)
        call add_proc(O_diff_t_S_t, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(H2O_O_t_react_t_S, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_t_t_S, site + (/0, -1, 0, 0/))
    end select


end subroutine put_O_Rh211_t

subroutine take_O_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, O, empty)

    ! disable affected processes
    if(avail_sites(H2O_O_t_N_react_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_t_N_react_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_t_react_s, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_t_react_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_t_react_t_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_N, site)
    endif

    if(avail_sites(H2O_O_t_react_t_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_S, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H_O_t_react, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_O_t_react, site)
    endif

    if(avail_sites(O_diff_t_N_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_t_N_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_t_S_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_S_t, site)
    endif

    if(avail_sites(O_diff_t_s, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_t_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_t_t_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_t_t_S, site + (/0, -1, 0, 0/))
    endif

    ! enable affected processes
    call add_proc(CH4_t_ads, site)
    call add_proc(CO_ads_t, site)
    call add_proc(H2O_t_ads, site)
    select case(get_species(site + (/0, 0, 0, Rh211_s - Rh211_t/)))
    case(CH)
        call add_proc(CH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(C)
        call add_proc(C_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CH3)
        call add_proc(CH3_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(O)
        call add_proc(H2O_O_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CH2)
        call add_proc(CH2_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CO)
        call add_proc(CO_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_s - Rh211_t/)))
    case(CH)
        call add_proc(CH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(C)
        call add_proc(C_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CH3)
        call add_proc(CH3_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(O)
        call add_proc(H2O_O_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CH2)
        call add_proc(CH2_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CO)
        call add_proc(CO_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(C)
        call add_proc(C_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CH3)
        call add_proc(CH3_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(O)
        call add_proc(H2O_O_t_react_t_N, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CH2)
        call add_proc(CH2_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CO)
        call add_proc(CO_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_diff_t_S_t, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_t_t_S, site)
    case(C)
        call add_proc(C_diff_t_t_S, site)
    case(CH3)
        call add_proc(CH3_diff_t_t_S, site)
    case(O)
        call add_proc(H2O_O_t_react_t_S, site)
        call add_proc(O_diff_t_t_S, site)
    case(CH2)
        call add_proc(CH2_diff_t_t_S, site)
    case(CO)
        call add_proc(CO_diff_t_t_S, site)
    case(OH)
        call add_proc(OH_diff_t_t_S, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    case(empty)
        select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_t/)))
        case(CO)
            call add_proc(H_CO_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        end select

    case(CH)
        call add_proc(CH_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        call add_proc(H_CH_f_react_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    case(empty)
        select case(get_species(site + (/1, -1, 0, Rh211_s - Rh211_t/)))
        case(CO)
            call add_proc(H_CO_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        end select

    case(CH)
        call add_proc(CH_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        call add_proc(H_CH_f_react_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    end select


end subroutine take_O_Rh211_t

subroutine put_O_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, O)

    ! disable affected processes
    if(avail_sites(CH2_s_E_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_s_E_dis_f, site)
    endif

    if(avail_sites(CH2_t_N_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_N_dis_f, site)
    endif

    if(avail_sites(CH2_t_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_dis_f, site)
    endif

    if(avail_sites(CH_diff_f_S_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_f_S_f, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_f_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_f_f_S, site)
    endif

    if(avail_sites(CH_diff_s_E_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_E_f, site)
    endif

    if(avail_sites(CH_diff_t_N_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_N_f, site)
    endif

    if(avail_sites(CH_diff_t_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_f, site)
    endif

    if(avail_sites(C_diff_f_S_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_f_S_f, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_f_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_f_f_S, site)
    endif

    if(avail_sites(C_diff_s_E_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_E_f, site)
    endif

    if(avail_sites(C_diff_t_N_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_N_f, site)
    endif

    if(avail_sites(C_diff_t_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_f, site)
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site)
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site)
    endif

    if(avail_sites(H_CO_t_react_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_t_react_f, site)
    endif

    if(avail_sites(H_CO_t_react_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_t_react_f_S, site)
    endif


end subroutine put_O_Rh211_f

subroutine take_O_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, O, empty)

    ! enable affected processes
    select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_f/)))
    case(C)
        call add_proc(C_diff_s_E_f, site)
    case(CH2)
        call add_proc(CH2_s_E_dis_f, site)
    case(CO)
        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(H_CO_s_react_t_NW, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(H_CO_s_react_t_W, site)
        end select

    case(CH)
        call add_proc(CH_diff_s_E_f, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
    case(C)
        call add_proc(C_diff_t_N_f, site)
    case(CH2)
        call add_proc(CH2_t_N_dis_f, site)
    case(CO)
        call add_proc(H_CO_t_react_f_S, site)
    case(CH)
        call add_proc(CH_diff_t_N_f, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
    case(C)
        call add_proc(C_diff_t_f, site)
    case(CH2)
        call add_proc(CH2_t_dis_f, site)
    case(CO)
        call add_proc(H_CO_t_react_f, site)
    case(CH)
        call add_proc(CH_diff_t_f, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(C)
        call add_proc(C_diff_f_S_f, site + (/0, -1, 0, 0/))
    case(CH)
        call add_proc(CH_diff_f_S_f, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(C)
        call add_proc(C_diff_f_f_S, site)
    case(CH)
        call add_proc(CH_diff_f_f_S, site)
    end select


end subroutine take_O_Rh211_f

subroutine put_OH_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, OH)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_s_N_s, site)
    endif

    if(avail_sites(CH2_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_N_s, site)
    endif

    if(avail_sites(CH2_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_s, site)
    endif

    if(avail_sites(CH3_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_s_N_s, site)
    endif

    if(avail_sites(CH3_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_N_s, site)
    endif

    if(avail_sites(CH3_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_s, site)
    endif

    if(avail_sites(CH4_s_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH4_s_ads, site)
    endif

    if(avail_sites(CH_diff_f_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(CH_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(CH_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_N_s, site)
    endif

    if(avail_sites(CH_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_N_s, site)
    endif

    if(avail_sites(CH_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_s, site)
    endif

    if(avail_sites(CO_ads_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_ads_s, site)
    endif

    if(avail_sites(CO_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_s_N_s, site)
    endif

    if(avail_sites(CO_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_N_s, site)
    endif

    if(avail_sites(CO_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_s, site)
    endif

    if(avail_sites(C_OH_s_react_t_NW, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_OH_s_react_t_W, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_f_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(C_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(C_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_N_s, site)
    endif

    if(avail_sites(C_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_N_s, site)
    endif

    if(avail_sites(C_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_s, site)
    endif

    if(avail_sites(H2O_O_s_react_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_s_react_s_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_s_react_s_S, site)
    endif

    if(avail_sites(H2O_O_t_N_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_N_react_s, site)
    endif

    if(avail_sites(H2O_O_t_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_s, site)
    endif

    if(avail_sites(H2O_s_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_s_ads, site)
    endif

    if(avail_sites(H_CH_f_react_s_E, lattice2nr(site(1) + (-1), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_s)), 2).ne.0)then
        call del_proc(H_CH_f_react_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    endif

    if(avail_sites(OH_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_s_N_s, site)
    endif

    if(avail_sites(OH_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_N_s, site)
    endif

    if(avail_sites(OH_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_s, site)
    endif

    if(avail_sites(O_diff_s_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_s_N_s, site)
    endif

    if(avail_sites(O_diff_s_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_s_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_t_N_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_N_s, site)
    endif

    if(avail_sites(O_diff_t_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_s, site)
    endif

    ! enable affected processes
    call add_proc(H_OH_s_react, site)
    call add_proc(OH_s_dis, site)
    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(OH_diff_s_s_N, site)
    case(OH)
        call add_proc(OH_OH_s_react_s_N, site)
        call add_proc(OH_OH_s_react_s_S, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(OH_diff_s_N_s, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_OH_s_react_s_N, site + (/0, -1, 0, 0/))
        call add_proc(OH_OH_s_react_s_S, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
    case(empty)
        call add_proc(OH_diff_s_t, site)
    case(OH)
        call add_proc(OH_OH_s_react_t, site)
        call add_proc(OH_OH_t_react_s, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
    case(empty)
        call add_proc(OH_diff_s_t_N, site)
    case(OH)
        call add_proc(OH_OH_s_react_t_N, site)
        call add_proc(OH_OH_t_N_react_s, site)
    end select


end subroutine put_OH_Rh211_s

subroutine take_OH_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, OH, empty)

    ! disable affected processes
    if(avail_sites(H_OH_s_react, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_OH_s_react, site)
    endif

    if(avail_sites(OH_OH_s_react_s_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_OH_s_react_s_N, site)
    endif

    if(avail_sites(OH_OH_s_react_s_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_OH_s_react_s_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_OH_s_react_s_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_OH_s_react_s_S, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_OH_s_react_s_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_OH_s_react_s_S, site)
    endif

    if(avail_sites(OH_OH_s_react_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_OH_s_react_t, site)
    endif

    if(avail_sites(OH_OH_s_react_t_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_OH_s_react_t_N, site)
    endif

    if(avail_sites(OH_OH_t_N_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_OH_t_N_react_s, site)
    endif

    if(avail_sites(OH_OH_t_react_s, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_OH_t_react_s, site)
    endif

    if(avail_sites(OH_diff_s_N_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_s_N_s, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_s_s_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_s_s_N, site)
    endif

    if(avail_sites(OH_diff_s_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_s_t, site)
    endif

    if(avail_sites(OH_diff_s_t_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_s_t_N, site)
    endif

    if(avail_sites(OH_s_dis, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_s_dis, site)
    endif

    ! enable affected processes
    call add_proc(CH4_s_ads, site)
    call add_proc(CO_ads_s, site)
    call add_proc(H2O_s_ads, site)
    select case(get_species(site + (/0, 1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_s_N_s, site)
    case(C)
        call add_proc(C_diff_s_N_s, site)
    case(CH3)
        call add_proc(CH3_diff_s_N_s, site)
    case(O)
        call add_proc(H2O_O_s_react_s_S, site)
        call add_proc(O_diff_s_N_s, site)
    case(CH2)
        call add_proc(CH2_diff_s_N_s, site)
    case(CO)
        call add_proc(CO_diff_s_N_s, site)
    case(OH)
        call add_proc(OH_diff_s_N_s, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(C)
        call add_proc(C_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CH3)
        call add_proc(CH3_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(O)
        call add_proc(H2O_O_s_react_s_N, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CH2)
        call add_proc(CH2_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(CO)
        call add_proc(CO_diff_s_s_N, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_diff_s_s_N, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
    case(CH)
        call add_proc(CH_diff_t_N_s, site)
    case(C)
        call add_proc(C_diff_t_N_s, site)
    case(CH3)
        call add_proc(CH3_diff_t_N_s, site)
    case(O)
        call add_proc(H2O_O_t_N_react_s, site)
        call add_proc(O_diff_t_N_s, site)
    case(CH2)
        call add_proc(CH2_diff_t_N_s, site)
    case(CO)
        call add_proc(CO_diff_t_N_s, site)
    case(OH)
        call add_proc(OH_diff_t_N_s, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
    case(CH)
        call add_proc(CH_diff_t_s, site)
    case(C)
        call add_proc(C_diff_t_s, site)
    case(CH3)
        call add_proc(CH3_diff_t_s, site)
    case(O)
        call add_proc(H2O_O_t_react_s, site)
        call add_proc(O_diff_t_s, site)
    case(CH2)
        call add_proc(CH2_diff_t_s, site)
    case(CO)
        call add_proc(CO_diff_t_s, site)
    case(OH)
        call add_proc(OH_diff_t_s, site)
    end select

    select case(get_species(site + (/-1, 0, 0, Rh211_f - Rh211_s/)))
    case(C)
        call add_proc(C_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        select case(get_species(site + (/-1, 1, 0, Rh211_t - Rh211_s/)))
        case(OH)
            call add_proc(C_OH_s_react_t_NW, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

        select case(get_species(site + (/-1, 0, 0, Rh211_t - Rh211_s/)))
        case(OH)
            call add_proc(C_OH_s_react_t_W, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        end select

    case(CH)
        call add_proc(CH_diff_f_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
        call add_proc(H_CH_f_react_s_E, site + (/-1, 0, 0, Rh211_f - Rh211_s/))
    end select


end subroutine take_OH_Rh211_s

subroutine put_OH_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, OH)

    ! disable affected processes
    if(avail_sites(CH2_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH2_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH2_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH2_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH2_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_diff_t_t_S, site)
    endif

    if(avail_sites(CH3_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH3_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH3_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH3_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH3_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH3_diff_t_t_S, site)
    endif

    if(avail_sites(CH4_t_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH4_t_ads, site)
    endif

    if(avail_sites(CH_diff_f_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_f_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(CH_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CH_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_t_S, site)
    endif

    if(avail_sites(CO_ads_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_ads_t, site)
    endif

    if(avail_sites(CO_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(CO_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(CO_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CO_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CO_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CO_diff_t_t_S, site)
    endif

    if(avail_sites(C_diff_f_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_f_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(C_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(C_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_t_S, site)
    endif

    if(avail_sites(H2O_O_s_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_s_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(H2O_O_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(H2O_O_t_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(H2O_O_t_react_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_O_t_react_t_S, site)
    endif

    if(avail_sites(H2O_t_ads, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H2O_t_ads, site)
    endif

    if(avail_sites(H_CH_f_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CH_f_react_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CH_f_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CH_f_react_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(OH_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_t_S, site)
    endif

    if(avail_sites(O_diff_s_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_s_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(O_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(O_diff_t_S_t, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(O_diff_t_S_t, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(O_diff_t_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(O_diff_t_t_S, site)
    endif

    ! enable affected processes
    call add_proc(H_OH_t_react, site)
    call add_proc(OH_t_dis, site)
    select case(get_species(site + (/0, 0, 0, Rh211_s - Rh211_t/)))
    case(empty)
        call add_proc(OH_diff_t_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_OH_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
        call add_proc(OH_OH_t_react_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_s - Rh211_t/)))
    case(empty)
        call add_proc(OH_diff_t_N_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_OH_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
        call add_proc(OH_OH_t_N_react_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(empty)
        call add_proc(OH_diff_t_S_t, site)
    case(OH)
        call add_proc(OH_OH_t_react_t_N, site)
        call add_proc(OH_OH_t_react_t_S, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(empty)
        call add_proc(OH_diff_t_t_S, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_OH_t_react_t_N, site + (/0, -1, 0, 0/))
        call add_proc(OH_OH_t_react_t_S, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_OH_t_react_f_S, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        select case(get_species(site + (/1, -1, 0, Rh211_s - Rh211_t/)))
        case(empty)
            call add_proc(C_OH_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        end select

    end select

    select case(get_species(site + (/0, 0, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_OH_t_react_f, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_t/)))
        case(empty)
            call add_proc(C_OH_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        end select

    end select


end subroutine put_OH_Rh211_t

subroutine take_OH_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, OH, empty)

    ! disable affected processes
    if(avail_sites(C_OH_s_react_t_NW, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_OH_s_react_t_W, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_OH_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_OH_t_react_f, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_OH_t_react_f, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(C_OH_t_react_f_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_f - Rh211_t)), 2).ne.0)then
        call del_proc(C_OH_t_react_f_S, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    endif

    if(avail_sites(H_OH_t_react, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_OH_t_react, site)
    endif

    if(avail_sites(OH_OH_s_react_t, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_OH_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_OH_s_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_OH_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_OH_t_N_react_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_OH_t_N_react_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_OH_t_react_s, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_OH_t_react_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_OH_t_react_t_N, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_OH_t_react_t_N, site)
    endif

    if(avail_sites(OH_OH_t_react_t_N, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_OH_t_react_t_N, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_OH_t_react_t_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_OH_t_react_t_S, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_OH_t_react_t_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_OH_t_react_t_S, site)
    endif

    if(avail_sites(OH_diff_t_N_s, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_t_N_s, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_t_S_t, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_diff_t_S_t, site)
    endif

    if(avail_sites(OH_diff_t_s, lattice2nr(site(1) + (0), site(2) + (0), site(3) + (0), site(4) + (Rh211_s - Rh211_t)), 2).ne.0)then
        call del_proc(OH_diff_t_s, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    endif

    if(avail_sites(OH_diff_t_t_S, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(OH_diff_t_t_S, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(OH_t_dis, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(OH_t_dis, site)
    endif

    ! enable affected processes
    call add_proc(CH4_t_ads, site)
    call add_proc(CO_ads_t, site)
    call add_proc(H2O_t_ads, site)
    select case(get_species(site + (/0, 0, 0, Rh211_s - Rh211_t/)))
    case(CH)
        call add_proc(CH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(C)
        call add_proc(C_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CH3)
        call add_proc(CH3_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(O)
        call add_proc(H2O_O_s_react_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CH2)
        call add_proc(CH2_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(CO)
        call add_proc(CO_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_diff_s_t, site + (/0, 0, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_s - Rh211_t/)))
    case(CH)
        call add_proc(CH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(C)
        call add_proc(C_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CH3)
        call add_proc(CH3_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(O)
        call add_proc(H2O_O_s_react_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
        call add_proc(O_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CH2)
        call add_proc(CH2_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(CO)
        call add_proc(CO_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    case(OH)
        call add_proc(OH_diff_s_t_N, site + (/0, -1, 0, Rh211_s - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(C)
        call add_proc(C_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CH3)
        call add_proc(CH3_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(O)
        call add_proc(H2O_O_t_react_t_N, site + (/0, -1, 0, 0/))
        call add_proc(O_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CH2)
        call add_proc(CH2_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(CO)
        call add_proc(CO_diff_t_S_t, site + (/0, -1, 0, 0/))
    case(OH)
        call add_proc(OH_diff_t_S_t, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(CH)
        call add_proc(CH_diff_t_t_S, site)
    case(C)
        call add_proc(C_diff_t_t_S, site)
    case(CH3)
        call add_proc(CH3_diff_t_t_S, site)
    case(O)
        call add_proc(H2O_O_t_react_t_S, site)
        call add_proc(O_diff_t_t_S, site)
    case(CH2)
        call add_proc(CH2_diff_t_t_S, site)
    case(CO)
        call add_proc(CO_diff_t_t_S, site)
    case(OH)
        call add_proc(OH_diff_t_t_S, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    case(empty)
        select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_t/)))
        case(CO)
            call add_proc(H_CO_s_react_t_W, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        end select

    case(CH)
        call add_proc(CH_diff_f_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
        call add_proc(H_CH_f_react_t, site + (/0, 0, 0, Rh211_f - Rh211_t/))
    end select

    select case(get_species(site + (/0, -1, 0, Rh211_f - Rh211_t/)))
    case(C)
        call add_proc(C_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    case(empty)
        select case(get_species(site + (/1, -1, 0, Rh211_s - Rh211_t/)))
        case(CO)
            call add_proc(H_CO_s_react_t_NW, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        end select

    case(CH)
        call add_proc(CH_diff_f_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
        call add_proc(H_CH_f_react_t_N, site + (/0, -1, 0, Rh211_f - Rh211_t/))
    end select


end subroutine take_OH_Rh211_t

subroutine put_OH_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, empty, OH)

    ! disable affected processes
    if(avail_sites(CH2_s_E_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_s_E_dis_f, site)
    endif

    if(avail_sites(CH2_t_N_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_N_dis_f, site)
    endif

    if(avail_sites(CH2_t_dis_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH2_t_dis_f, site)
    endif

    if(avail_sites(CH_diff_f_S_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(CH_diff_f_S_f, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(CH_diff_f_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_f_f_S, site)
    endif

    if(avail_sites(CH_diff_s_E_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_s_E_f, site)
    endif

    if(avail_sites(CH_diff_t_N_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_N_f, site)
    endif

    if(avail_sites(CH_diff_t_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(CH_diff_t_f, site)
    endif

    if(avail_sites(C_diff_f_S_f, lattice2nr(site(1) + (0), site(2) + (-1), site(3) + (0), site(4) + (0)), 2).ne.0)then
        call del_proc(C_diff_f_S_f, site + (/0, -1, 0, 0/))
    endif

    if(avail_sites(C_diff_f_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_f_f_S, site)
    endif

    if(avail_sites(C_diff_s_E_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_s_E_f, site)
    endif

    if(avail_sites(C_diff_t_N_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_N_f, site)
    endif

    if(avail_sites(C_diff_t_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(C_diff_t_f, site)
    endif

    if(avail_sites(H_CO_s_react_t_NW, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_NW, site)
    endif

    if(avail_sites(H_CO_s_react_t_W, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_s_react_t_W, site)
    endif

    if(avail_sites(H_CO_t_react_f, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_t_react_f, site)
    endif

    if(avail_sites(H_CO_t_react_f_S, lattice2nr(site(1), site(2), site(3), site(4)), 2).ne.0)then
        call del_proc(H_CO_t_react_f_S, site)
    endif


end subroutine put_OH_Rh211_f

subroutine take_OH_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    ! update lattice
    call replace_species(site, OH, empty)

    ! enable affected processes
    select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_f/)))
    case(C)
        call add_proc(C_diff_s_E_f, site)
    case(CH2)
        call add_proc(CH2_s_E_dis_f, site)
    case(CO)
        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(H_CO_s_react_t_NW, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(H_CO_s_react_t_W, site)
        end select

    case(CH)
        call add_proc(CH_diff_s_E_f, site)
    end select

    select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
    case(C)
        call add_proc(C_diff_t_N_f, site)
    case(CH2)
        call add_proc(CH2_t_N_dis_f, site)
    case(CO)
        call add_proc(H_CO_t_react_f_S, site)
    case(CH)
        call add_proc(CH_diff_t_N_f, site)
    end select

    select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
    case(C)
        call add_proc(C_diff_t_f, site)
    case(CH2)
        call add_proc(CH2_t_dis_f, site)
    case(CO)
        call add_proc(H_CO_t_react_f, site)
    case(CH)
        call add_proc(CH_diff_t_f, site)
    end select

    select case(get_species(site + (/0, -1, 0, 0/)))
    case(C)
        call add_proc(C_diff_f_S_f, site + (/0, -1, 0, 0/))
    case(CH)
        call add_proc(CH_diff_f_S_f, site + (/0, -1, 0, 0/))
    end select

    select case(get_species(site + (/0, 1, 0, 0/)))
    case(C)
        call add_proc(C_diff_f_f_S, site)
    case(CH)
        call add_proc(CH_diff_f_f_S, site)
    end select


end subroutine take_OH_Rh211_f

subroutine touchup_Rh211_s(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    if (can_do(CH2_diff_s_N_s, site)) then
        call del_proc(CH2_diff_s_N_s, site)
    endif
    if (can_do(CH2_diff_s_s_N, site)) then
        call del_proc(CH2_diff_s_s_N, site)
    endif
    if (can_do(CH2_diff_s_t, site)) then
        call del_proc(CH2_diff_s_t, site)
    endif
    if (can_do(CH2_diff_s_t_N, site)) then
        call del_proc(CH2_diff_s_t_N, site)
    endif
    if (can_do(CH2_diff_t_N_s, site)) then
        call del_proc(CH2_diff_t_N_s, site)
    endif
    if (can_do(CH2_diff_t_S_t, site)) then
        call del_proc(CH2_diff_t_S_t, site)
    endif
    if (can_do(CH2_diff_t_s, site)) then
        call del_proc(CH2_diff_t_s, site)
    endif
    if (can_do(CH2_diff_t_t_S, site)) then
        call del_proc(CH2_diff_t_t_S, site)
    endif
    if (can_do(CH2_s_E_dis_f, site)) then
        call del_proc(CH2_s_E_dis_f, site)
    endif
    if (can_do(CH2_s_dis, site)) then
        call del_proc(CH2_s_dis, site)
    endif
    if (can_do(CH2_t_N_dis_f, site)) then
        call del_proc(CH2_t_N_dis_f, site)
    endif
    if (can_do(CH2_t_dis, site)) then
        call del_proc(CH2_t_dis, site)
    endif
    if (can_do(CH2_t_dis_f, site)) then
        call del_proc(CH2_t_dis_f, site)
    endif
    if (can_do(CH3_diff_s_N_s, site)) then
        call del_proc(CH3_diff_s_N_s, site)
    endif
    if (can_do(CH3_diff_s_s_N, site)) then
        call del_proc(CH3_diff_s_s_N, site)
    endif
    if (can_do(CH3_diff_s_t, site)) then
        call del_proc(CH3_diff_s_t, site)
    endif
    if (can_do(CH3_diff_s_t_N, site)) then
        call del_proc(CH3_diff_s_t_N, site)
    endif
    if (can_do(CH3_diff_t_N_s, site)) then
        call del_proc(CH3_diff_t_N_s, site)
    endif
    if (can_do(CH3_diff_t_S_t, site)) then
        call del_proc(CH3_diff_t_S_t, site)
    endif
    if (can_do(CH3_diff_t_s, site)) then
        call del_proc(CH3_diff_t_s, site)
    endif
    if (can_do(CH3_diff_t_t_S, site)) then
        call del_proc(CH3_diff_t_t_S, site)
    endif
    if (can_do(CH3_s_dis, site)) then
        call del_proc(CH3_s_dis, site)
    endif
    if (can_do(CH3_t_dis, site)) then
        call del_proc(CH3_t_dis, site)
    endif
    if (can_do(CH4_s_ads, site)) then
        call del_proc(CH4_s_ads, site)
    endif
    if (can_do(CH4_t_ads, site)) then
        call del_proc(CH4_t_ads, site)
    endif
    if (can_do(CH_diff_f_S_f, site)) then
        call del_proc(CH_diff_f_S_f, site)
    endif
    if (can_do(CH_diff_f_f_S, site)) then
        call del_proc(CH_diff_f_f_S, site)
    endif
    if (can_do(CH_diff_f_s_E, site)) then
        call del_proc(CH_diff_f_s_E, site)
    endif
    if (can_do(CH_diff_f_t, site)) then
        call del_proc(CH_diff_f_t, site)
    endif
    if (can_do(CH_diff_f_t_N, site)) then
        call del_proc(CH_diff_f_t_N, site)
    endif
    if (can_do(CH_diff_s_E_f, site)) then
        call del_proc(CH_diff_s_E_f, site)
    endif
    if (can_do(CH_diff_s_N_s, site)) then
        call del_proc(CH_diff_s_N_s, site)
    endif
    if (can_do(CH_diff_s_s_N, site)) then
        call del_proc(CH_diff_s_s_N, site)
    endif
    if (can_do(CH_diff_s_t, site)) then
        call del_proc(CH_diff_s_t, site)
    endif
    if (can_do(CH_diff_s_t_N, site)) then
        call del_proc(CH_diff_s_t_N, site)
    endif
    if (can_do(CH_diff_t_N_f, site)) then
        call del_proc(CH_diff_t_N_f, site)
    endif
    if (can_do(CH_diff_t_N_s, site)) then
        call del_proc(CH_diff_t_N_s, site)
    endif
    if (can_do(CH_diff_t_S_t, site)) then
        call del_proc(CH_diff_t_S_t, site)
    endif
    if (can_do(CH_diff_t_f, site)) then
        call del_proc(CH_diff_t_f, site)
    endif
    if (can_do(CH_diff_t_s, site)) then
        call del_proc(CH_diff_t_s, site)
    endif
    if (can_do(CH_diff_t_t_S, site)) then
        call del_proc(CH_diff_t_t_S, site)
    endif
    if (can_do(CH_f_dis, site)) then
        call del_proc(CH_f_dis, site)
    endif
    if (can_do(CH_s_dis, site)) then
        call del_proc(CH_s_dis, site)
    endif
    if (can_do(CH_t_dis, site)) then
        call del_proc(CH_t_dis, site)
    endif
    if (can_do(CO_ads_s, site)) then
        call del_proc(CO_ads_s, site)
    endif
    if (can_do(CO_ads_t, site)) then
        call del_proc(CO_ads_t, site)
    endif
    if (can_do(CO_des_s, site)) then
        call del_proc(CO_des_s, site)
    endif
    if (can_do(CO_des_t, site)) then
        call del_proc(CO_des_t, site)
    endif
    if (can_do(CO_diff_s_N_s, site)) then
        call del_proc(CO_diff_s_N_s, site)
    endif
    if (can_do(CO_diff_s_s_N, site)) then
        call del_proc(CO_diff_s_s_N, site)
    endif
    if (can_do(CO_diff_s_t, site)) then
        call del_proc(CO_diff_s_t, site)
    endif
    if (can_do(CO_diff_s_t_N, site)) then
        call del_proc(CO_diff_s_t_N, site)
    endif
    if (can_do(CO_diff_t_N_s, site)) then
        call del_proc(CO_diff_t_N_s, site)
    endif
    if (can_do(CO_diff_t_S_t, site)) then
        call del_proc(CO_diff_t_S_t, site)
    endif
    if (can_do(CO_diff_t_s, site)) then
        call del_proc(CO_diff_t_s, site)
    endif
    if (can_do(CO_diff_t_t_S, site)) then
        call del_proc(CO_diff_t_t_S, site)
    endif
    if (can_do(C_OH_s_react_t_NW, site)) then
        call del_proc(C_OH_s_react_t_NW, site)
    endif
    if (can_do(C_OH_s_react_t_W, site)) then
        call del_proc(C_OH_s_react_t_W, site)
    endif
    if (can_do(C_OH_t_react_f, site)) then
        call del_proc(C_OH_t_react_f, site)
    endif
    if (can_do(C_OH_t_react_f_S, site)) then
        call del_proc(C_OH_t_react_f_S, site)
    endif
    if (can_do(C_diff_f_S_f, site)) then
        call del_proc(C_diff_f_S_f, site)
    endif
    if (can_do(C_diff_f_f_S, site)) then
        call del_proc(C_diff_f_f_S, site)
    endif
    if (can_do(C_diff_f_s_E, site)) then
        call del_proc(C_diff_f_s_E, site)
    endif
    if (can_do(C_diff_f_t, site)) then
        call del_proc(C_diff_f_t, site)
    endif
    if (can_do(C_diff_f_t_N, site)) then
        call del_proc(C_diff_f_t_N, site)
    endif
    if (can_do(C_diff_s_E_f, site)) then
        call del_proc(C_diff_s_E_f, site)
    endif
    if (can_do(C_diff_s_N_s, site)) then
        call del_proc(C_diff_s_N_s, site)
    endif
    if (can_do(C_diff_s_s_N, site)) then
        call del_proc(C_diff_s_s_N, site)
    endif
    if (can_do(C_diff_s_t, site)) then
        call del_proc(C_diff_s_t, site)
    endif
    if (can_do(C_diff_s_t_N, site)) then
        call del_proc(C_diff_s_t_N, site)
    endif
    if (can_do(C_diff_t_N_f, site)) then
        call del_proc(C_diff_t_N_f, site)
    endif
    if (can_do(C_diff_t_N_s, site)) then
        call del_proc(C_diff_t_N_s, site)
    endif
    if (can_do(C_diff_t_S_t, site)) then
        call del_proc(C_diff_t_S_t, site)
    endif
    if (can_do(C_diff_t_f, site)) then
        call del_proc(C_diff_t_f, site)
    endif
    if (can_do(C_diff_t_s, site)) then
        call del_proc(C_diff_t_s, site)
    endif
    if (can_do(C_diff_t_t_S, site)) then
        call del_proc(C_diff_t_t_S, site)
    endif
    if (can_do(H2O_O_s_react_s_N, site)) then
        call del_proc(H2O_O_s_react_s_N, site)
    endif
    if (can_do(H2O_O_s_react_s_S, site)) then
        call del_proc(H2O_O_s_react_s_S, site)
    endif
    if (can_do(H2O_O_s_react_t, site)) then
        call del_proc(H2O_O_s_react_t, site)
    endif
    if (can_do(H2O_O_s_react_t_N, site)) then
        call del_proc(H2O_O_s_react_t_N, site)
    endif
    if (can_do(H2O_O_t_N_react_s, site)) then
        call del_proc(H2O_O_t_N_react_s, site)
    endif
    if (can_do(H2O_O_t_react_s, site)) then
        call del_proc(H2O_O_t_react_s, site)
    endif
    if (can_do(H2O_O_t_react_t_N, site)) then
        call del_proc(H2O_O_t_react_t_N, site)
    endif
    if (can_do(H2O_O_t_react_t_S, site)) then
        call del_proc(H2O_O_t_react_t_S, site)
    endif
    if (can_do(H2O_s_ads, site)) then
        call del_proc(H2O_s_ads, site)
    endif
    if (can_do(H2O_t_ads, site)) then
        call del_proc(H2O_t_ads, site)
    endif
    if (can_do(H_CH2_s_react, site)) then
        call del_proc(H_CH2_s_react, site)
    endif
    if (can_do(H_CH2_t_react, site)) then
        call del_proc(H_CH2_t_react, site)
    endif
    if (can_do(H_CH3_s_react, site)) then
        call del_proc(H_CH3_s_react, site)
    endif
    if (can_do(H_CH3_t_react, site)) then
        call del_proc(H_CH3_t_react, site)
    endif
    if (can_do(H_CH_f_react_s_E, site)) then
        call del_proc(H_CH_f_react_s_E, site)
    endif
    if (can_do(H_CH_f_react_t, site)) then
        call del_proc(H_CH_f_react_t, site)
    endif
    if (can_do(H_CH_f_react_t_N, site)) then
        call del_proc(H_CH_f_react_t_N, site)
    endif
    if (can_do(H_CH_s_react, site)) then
        call del_proc(H_CH_s_react, site)
    endif
    if (can_do(H_CH_t_react, site)) then
        call del_proc(H_CH_t_react, site)
    endif
    if (can_do(H_CO_s_react_t_NW, site)) then
        call del_proc(H_CO_s_react_t_NW, site)
    endif
    if (can_do(H_CO_s_react_t_W, site)) then
        call del_proc(H_CO_s_react_t_W, site)
    endif
    if (can_do(H_CO_t_react_f, site)) then
        call del_proc(H_CO_t_react_f, site)
    endif
    if (can_do(H_CO_t_react_f_S, site)) then
        call del_proc(H_CO_t_react_f_S, site)
    endif
    if (can_do(H_C_f_react, site)) then
        call del_proc(H_C_f_react, site)
    endif
    if (can_do(H_C_s_react, site)) then
        call del_proc(H_C_s_react, site)
    endif
    if (can_do(H_C_t_react, site)) then
        call del_proc(H_C_t_react, site)
    endif
    if (can_do(H_OH_s_react, site)) then
        call del_proc(H_OH_s_react, site)
    endif
    if (can_do(H_OH_t_react, site)) then
        call del_proc(H_OH_t_react, site)
    endif
    if (can_do(H_O_s_react, site)) then
        call del_proc(H_O_s_react, site)
    endif
    if (can_do(H_O_t_react, site)) then
        call del_proc(H_O_t_react, site)
    endif
    if (can_do(OH_OH_s_react_s_N, site)) then
        call del_proc(OH_OH_s_react_s_N, site)
    endif
    if (can_do(OH_OH_s_react_s_S, site)) then
        call del_proc(OH_OH_s_react_s_S, site)
    endif
    if (can_do(OH_OH_s_react_t, site)) then
        call del_proc(OH_OH_s_react_t, site)
    endif
    if (can_do(OH_OH_s_react_t_N, site)) then
        call del_proc(OH_OH_s_react_t_N, site)
    endif
    if (can_do(OH_OH_t_N_react_s, site)) then
        call del_proc(OH_OH_t_N_react_s, site)
    endif
    if (can_do(OH_OH_t_react_s, site)) then
        call del_proc(OH_OH_t_react_s, site)
    endif
    if (can_do(OH_OH_t_react_t_N, site)) then
        call del_proc(OH_OH_t_react_t_N, site)
    endif
    if (can_do(OH_OH_t_react_t_S, site)) then
        call del_proc(OH_OH_t_react_t_S, site)
    endif
    if (can_do(OH_diff_s_N_s, site)) then
        call del_proc(OH_diff_s_N_s, site)
    endif
    if (can_do(OH_diff_s_s_N, site)) then
        call del_proc(OH_diff_s_s_N, site)
    endif
    if (can_do(OH_diff_s_t, site)) then
        call del_proc(OH_diff_s_t, site)
    endif
    if (can_do(OH_diff_s_t_N, site)) then
        call del_proc(OH_diff_s_t_N, site)
    endif
    if (can_do(OH_diff_t_N_s, site)) then
        call del_proc(OH_diff_t_N_s, site)
    endif
    if (can_do(OH_diff_t_S_t, site)) then
        call del_proc(OH_diff_t_S_t, site)
    endif
    if (can_do(OH_diff_t_s, site)) then
        call del_proc(OH_diff_t_s, site)
    endif
    if (can_do(OH_diff_t_t_S, site)) then
        call del_proc(OH_diff_t_t_S, site)
    endif
    if (can_do(OH_s_dis, site)) then
        call del_proc(OH_s_dis, site)
    endif
    if (can_do(OH_t_dis, site)) then
        call del_proc(OH_t_dis, site)
    endif
    if (can_do(O_diff_s_N_s, site)) then
        call del_proc(O_diff_s_N_s, site)
    endif
    if (can_do(O_diff_s_s_N, site)) then
        call del_proc(O_diff_s_s_N, site)
    endif
    if (can_do(O_diff_s_t, site)) then
        call del_proc(O_diff_s_t, site)
    endif
    if (can_do(O_diff_s_t_N, site)) then
        call del_proc(O_diff_s_t_N, site)
    endif
    if (can_do(O_diff_t_N_s, site)) then
        call del_proc(O_diff_t_N_s, site)
    endif
    if (can_do(O_diff_t_S_t, site)) then
        call del_proc(O_diff_t_S_t, site)
    endif
    if (can_do(O_diff_t_s, site)) then
        call del_proc(O_diff_t_s, site)
    endif
    if (can_do(O_diff_t_t_S, site)) then
        call del_proc(O_diff_t_t_S, site)
    endif
    select case(get_species(site))
    case(empty)
        call add_proc(CH4_s_ads, site)
        call add_proc(CO_ads_s, site)
        call add_proc(H2O_s_ads, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(CH)
            call add_proc(CH_diff_s_N_s, site)
        case(C)
            call add_proc(C_diff_s_N_s, site)
        case(CH3)
            call add_proc(CH3_diff_s_N_s, site)
        case(O)
            call add_proc(H2O_O_s_react_s_S, site)
            call add_proc(O_diff_s_N_s, site)
        case(CH2)
            call add_proc(CH2_diff_s_N_s, site)
        case(CO)
            call add_proc(CO_diff_s_N_s, site)
        case(OH)
            call add_proc(OH_diff_s_N_s, site)
        end select

        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
        case(CH)
            call add_proc(CH_diff_t_N_s, site)
        case(C)
            call add_proc(C_diff_t_N_s, site)
        case(CH3)
            call add_proc(CH3_diff_t_N_s, site)
        case(O)
            call add_proc(H2O_O_t_N_react_s, site)
            call add_proc(O_diff_t_N_s, site)
        case(CH2)
            call add_proc(CH2_diff_t_N_s, site)
        case(CO)
            call add_proc(CO_diff_t_N_s, site)
        case(OH)
            call add_proc(OH_diff_t_N_s, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
        case(CH)
            call add_proc(CH_diff_t_s, site)
        case(C)
            call add_proc(C_diff_t_s, site)
        case(CH3)
            call add_proc(CH3_diff_t_s, site)
        case(O)
            call add_proc(H2O_O_t_react_s, site)
            call add_proc(O_diff_t_s, site)
        case(CH2)
            call add_proc(CH2_diff_t_s, site)
        case(CO)
            call add_proc(CO_diff_t_s, site)
        case(OH)
            call add_proc(OH_diff_t_s, site)
        end select

    case(CH)
        call add_proc(CH_s_dis, site)
        call add_proc(H_CH_s_react, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(CH_diff_s_s_N, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(CH_diff_s_t, site)
        end select

        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(CH_diff_s_t_N, site)
        end select

    case(CH3)
        call add_proc(CH3_s_dis, site)
        call add_proc(H_CH3_s_react, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(CH3_diff_s_s_N, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(CH3_diff_s_t, site)
        end select

        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(CH3_diff_s_t_N, site)
        end select

    case(C)
        call add_proc(H_C_s_react, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(C_diff_s_s_N, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(C_diff_s_t, site)
        end select

        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(C_diff_s_t_N, site)
        end select

    case(O)
        call add_proc(H_O_s_react, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(H2O_O_s_react_s_N, site)
            call add_proc(O_diff_s_s_N, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(H2O_O_s_react_t, site)
            call add_proc(O_diff_s_t, site)
        end select

        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(H2O_O_s_react_t_N, site)
            call add_proc(O_diff_s_t_N, site)
        end select

    case(CH2)
        call add_proc(CH2_s_dis, site)
        call add_proc(H_CH2_s_react, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(CH2_diff_s_s_N, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(CH2_diff_s_t, site)
        end select

        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(CH2_diff_s_t_N, site)
        end select

    case(CO)
        call add_proc(CO_des_s, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(CO_diff_s_s_N, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(CO_diff_s_t, site)
        end select

        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(CO_diff_s_t_N, site)
        end select

    case(OH)
        call add_proc(H_OH_s_react, site)
        call add_proc(OH_s_dis, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(OH_diff_s_s_N, site)
        case(OH)
            call add_proc(OH_OH_s_react_s_N, site)
            call add_proc(OH_OH_s_react_s_S, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(OH_diff_s_t, site)
        case(OH)
            call add_proc(OH_OH_s_react_t, site)
            call add_proc(OH_OH_t_react_s, site)
        end select

        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_s/)))
        case(empty)
            call add_proc(OH_diff_s_t_N, site)
        case(OH)
            call add_proc(OH_OH_s_react_t_N, site)
            call add_proc(OH_OH_t_N_react_s, site)
        end select

    end select

end subroutine touchup_Rh211_s

subroutine touchup_Rh211_t(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    if (can_do(CH2_diff_s_N_s, site)) then
        call del_proc(CH2_diff_s_N_s, site)
    endif
    if (can_do(CH2_diff_s_s_N, site)) then
        call del_proc(CH2_diff_s_s_N, site)
    endif
    if (can_do(CH2_diff_s_t, site)) then
        call del_proc(CH2_diff_s_t, site)
    endif
    if (can_do(CH2_diff_s_t_N, site)) then
        call del_proc(CH2_diff_s_t_N, site)
    endif
    if (can_do(CH2_diff_t_N_s, site)) then
        call del_proc(CH2_diff_t_N_s, site)
    endif
    if (can_do(CH2_diff_t_S_t, site)) then
        call del_proc(CH2_diff_t_S_t, site)
    endif
    if (can_do(CH2_diff_t_s, site)) then
        call del_proc(CH2_diff_t_s, site)
    endif
    if (can_do(CH2_diff_t_t_S, site)) then
        call del_proc(CH2_diff_t_t_S, site)
    endif
    if (can_do(CH2_s_E_dis_f, site)) then
        call del_proc(CH2_s_E_dis_f, site)
    endif
    if (can_do(CH2_s_dis, site)) then
        call del_proc(CH2_s_dis, site)
    endif
    if (can_do(CH2_t_N_dis_f, site)) then
        call del_proc(CH2_t_N_dis_f, site)
    endif
    if (can_do(CH2_t_dis, site)) then
        call del_proc(CH2_t_dis, site)
    endif
    if (can_do(CH2_t_dis_f, site)) then
        call del_proc(CH2_t_dis_f, site)
    endif
    if (can_do(CH3_diff_s_N_s, site)) then
        call del_proc(CH3_diff_s_N_s, site)
    endif
    if (can_do(CH3_diff_s_s_N, site)) then
        call del_proc(CH3_diff_s_s_N, site)
    endif
    if (can_do(CH3_diff_s_t, site)) then
        call del_proc(CH3_diff_s_t, site)
    endif
    if (can_do(CH3_diff_s_t_N, site)) then
        call del_proc(CH3_diff_s_t_N, site)
    endif
    if (can_do(CH3_diff_t_N_s, site)) then
        call del_proc(CH3_diff_t_N_s, site)
    endif
    if (can_do(CH3_diff_t_S_t, site)) then
        call del_proc(CH3_diff_t_S_t, site)
    endif
    if (can_do(CH3_diff_t_s, site)) then
        call del_proc(CH3_diff_t_s, site)
    endif
    if (can_do(CH3_diff_t_t_S, site)) then
        call del_proc(CH3_diff_t_t_S, site)
    endif
    if (can_do(CH3_s_dis, site)) then
        call del_proc(CH3_s_dis, site)
    endif
    if (can_do(CH3_t_dis, site)) then
        call del_proc(CH3_t_dis, site)
    endif
    if (can_do(CH4_s_ads, site)) then
        call del_proc(CH4_s_ads, site)
    endif
    if (can_do(CH4_t_ads, site)) then
        call del_proc(CH4_t_ads, site)
    endif
    if (can_do(CH_diff_f_S_f, site)) then
        call del_proc(CH_diff_f_S_f, site)
    endif
    if (can_do(CH_diff_f_f_S, site)) then
        call del_proc(CH_diff_f_f_S, site)
    endif
    if (can_do(CH_diff_f_s_E, site)) then
        call del_proc(CH_diff_f_s_E, site)
    endif
    if (can_do(CH_diff_f_t, site)) then
        call del_proc(CH_diff_f_t, site)
    endif
    if (can_do(CH_diff_f_t_N, site)) then
        call del_proc(CH_diff_f_t_N, site)
    endif
    if (can_do(CH_diff_s_E_f, site)) then
        call del_proc(CH_diff_s_E_f, site)
    endif
    if (can_do(CH_diff_s_N_s, site)) then
        call del_proc(CH_diff_s_N_s, site)
    endif
    if (can_do(CH_diff_s_s_N, site)) then
        call del_proc(CH_diff_s_s_N, site)
    endif
    if (can_do(CH_diff_s_t, site)) then
        call del_proc(CH_diff_s_t, site)
    endif
    if (can_do(CH_diff_s_t_N, site)) then
        call del_proc(CH_diff_s_t_N, site)
    endif
    if (can_do(CH_diff_t_N_f, site)) then
        call del_proc(CH_diff_t_N_f, site)
    endif
    if (can_do(CH_diff_t_N_s, site)) then
        call del_proc(CH_diff_t_N_s, site)
    endif
    if (can_do(CH_diff_t_S_t, site)) then
        call del_proc(CH_diff_t_S_t, site)
    endif
    if (can_do(CH_diff_t_f, site)) then
        call del_proc(CH_diff_t_f, site)
    endif
    if (can_do(CH_diff_t_s, site)) then
        call del_proc(CH_diff_t_s, site)
    endif
    if (can_do(CH_diff_t_t_S, site)) then
        call del_proc(CH_diff_t_t_S, site)
    endif
    if (can_do(CH_f_dis, site)) then
        call del_proc(CH_f_dis, site)
    endif
    if (can_do(CH_s_dis, site)) then
        call del_proc(CH_s_dis, site)
    endif
    if (can_do(CH_t_dis, site)) then
        call del_proc(CH_t_dis, site)
    endif
    if (can_do(CO_ads_s, site)) then
        call del_proc(CO_ads_s, site)
    endif
    if (can_do(CO_ads_t, site)) then
        call del_proc(CO_ads_t, site)
    endif
    if (can_do(CO_des_s, site)) then
        call del_proc(CO_des_s, site)
    endif
    if (can_do(CO_des_t, site)) then
        call del_proc(CO_des_t, site)
    endif
    if (can_do(CO_diff_s_N_s, site)) then
        call del_proc(CO_diff_s_N_s, site)
    endif
    if (can_do(CO_diff_s_s_N, site)) then
        call del_proc(CO_diff_s_s_N, site)
    endif
    if (can_do(CO_diff_s_t, site)) then
        call del_proc(CO_diff_s_t, site)
    endif
    if (can_do(CO_diff_s_t_N, site)) then
        call del_proc(CO_diff_s_t_N, site)
    endif
    if (can_do(CO_diff_t_N_s, site)) then
        call del_proc(CO_diff_t_N_s, site)
    endif
    if (can_do(CO_diff_t_S_t, site)) then
        call del_proc(CO_diff_t_S_t, site)
    endif
    if (can_do(CO_diff_t_s, site)) then
        call del_proc(CO_diff_t_s, site)
    endif
    if (can_do(CO_diff_t_t_S, site)) then
        call del_proc(CO_diff_t_t_S, site)
    endif
    if (can_do(C_OH_s_react_t_NW, site)) then
        call del_proc(C_OH_s_react_t_NW, site)
    endif
    if (can_do(C_OH_s_react_t_W, site)) then
        call del_proc(C_OH_s_react_t_W, site)
    endif
    if (can_do(C_OH_t_react_f, site)) then
        call del_proc(C_OH_t_react_f, site)
    endif
    if (can_do(C_OH_t_react_f_S, site)) then
        call del_proc(C_OH_t_react_f_S, site)
    endif
    if (can_do(C_diff_f_S_f, site)) then
        call del_proc(C_diff_f_S_f, site)
    endif
    if (can_do(C_diff_f_f_S, site)) then
        call del_proc(C_diff_f_f_S, site)
    endif
    if (can_do(C_diff_f_s_E, site)) then
        call del_proc(C_diff_f_s_E, site)
    endif
    if (can_do(C_diff_f_t, site)) then
        call del_proc(C_diff_f_t, site)
    endif
    if (can_do(C_diff_f_t_N, site)) then
        call del_proc(C_diff_f_t_N, site)
    endif
    if (can_do(C_diff_s_E_f, site)) then
        call del_proc(C_diff_s_E_f, site)
    endif
    if (can_do(C_diff_s_N_s, site)) then
        call del_proc(C_diff_s_N_s, site)
    endif
    if (can_do(C_diff_s_s_N, site)) then
        call del_proc(C_diff_s_s_N, site)
    endif
    if (can_do(C_diff_s_t, site)) then
        call del_proc(C_diff_s_t, site)
    endif
    if (can_do(C_diff_s_t_N, site)) then
        call del_proc(C_diff_s_t_N, site)
    endif
    if (can_do(C_diff_t_N_f, site)) then
        call del_proc(C_diff_t_N_f, site)
    endif
    if (can_do(C_diff_t_N_s, site)) then
        call del_proc(C_diff_t_N_s, site)
    endif
    if (can_do(C_diff_t_S_t, site)) then
        call del_proc(C_diff_t_S_t, site)
    endif
    if (can_do(C_diff_t_f, site)) then
        call del_proc(C_diff_t_f, site)
    endif
    if (can_do(C_diff_t_s, site)) then
        call del_proc(C_diff_t_s, site)
    endif
    if (can_do(C_diff_t_t_S, site)) then
        call del_proc(C_diff_t_t_S, site)
    endif
    if (can_do(H2O_O_s_react_s_N, site)) then
        call del_proc(H2O_O_s_react_s_N, site)
    endif
    if (can_do(H2O_O_s_react_s_S, site)) then
        call del_proc(H2O_O_s_react_s_S, site)
    endif
    if (can_do(H2O_O_s_react_t, site)) then
        call del_proc(H2O_O_s_react_t, site)
    endif
    if (can_do(H2O_O_s_react_t_N, site)) then
        call del_proc(H2O_O_s_react_t_N, site)
    endif
    if (can_do(H2O_O_t_N_react_s, site)) then
        call del_proc(H2O_O_t_N_react_s, site)
    endif
    if (can_do(H2O_O_t_react_s, site)) then
        call del_proc(H2O_O_t_react_s, site)
    endif
    if (can_do(H2O_O_t_react_t_N, site)) then
        call del_proc(H2O_O_t_react_t_N, site)
    endif
    if (can_do(H2O_O_t_react_t_S, site)) then
        call del_proc(H2O_O_t_react_t_S, site)
    endif
    if (can_do(H2O_s_ads, site)) then
        call del_proc(H2O_s_ads, site)
    endif
    if (can_do(H2O_t_ads, site)) then
        call del_proc(H2O_t_ads, site)
    endif
    if (can_do(H_CH2_s_react, site)) then
        call del_proc(H_CH2_s_react, site)
    endif
    if (can_do(H_CH2_t_react, site)) then
        call del_proc(H_CH2_t_react, site)
    endif
    if (can_do(H_CH3_s_react, site)) then
        call del_proc(H_CH3_s_react, site)
    endif
    if (can_do(H_CH3_t_react, site)) then
        call del_proc(H_CH3_t_react, site)
    endif
    if (can_do(H_CH_f_react_s_E, site)) then
        call del_proc(H_CH_f_react_s_E, site)
    endif
    if (can_do(H_CH_f_react_t, site)) then
        call del_proc(H_CH_f_react_t, site)
    endif
    if (can_do(H_CH_f_react_t_N, site)) then
        call del_proc(H_CH_f_react_t_N, site)
    endif
    if (can_do(H_CH_s_react, site)) then
        call del_proc(H_CH_s_react, site)
    endif
    if (can_do(H_CH_t_react, site)) then
        call del_proc(H_CH_t_react, site)
    endif
    if (can_do(H_CO_s_react_t_NW, site)) then
        call del_proc(H_CO_s_react_t_NW, site)
    endif
    if (can_do(H_CO_s_react_t_W, site)) then
        call del_proc(H_CO_s_react_t_W, site)
    endif
    if (can_do(H_CO_t_react_f, site)) then
        call del_proc(H_CO_t_react_f, site)
    endif
    if (can_do(H_CO_t_react_f_S, site)) then
        call del_proc(H_CO_t_react_f_S, site)
    endif
    if (can_do(H_C_f_react, site)) then
        call del_proc(H_C_f_react, site)
    endif
    if (can_do(H_C_s_react, site)) then
        call del_proc(H_C_s_react, site)
    endif
    if (can_do(H_C_t_react, site)) then
        call del_proc(H_C_t_react, site)
    endif
    if (can_do(H_OH_s_react, site)) then
        call del_proc(H_OH_s_react, site)
    endif
    if (can_do(H_OH_t_react, site)) then
        call del_proc(H_OH_t_react, site)
    endif
    if (can_do(H_O_s_react, site)) then
        call del_proc(H_O_s_react, site)
    endif
    if (can_do(H_O_t_react, site)) then
        call del_proc(H_O_t_react, site)
    endif
    if (can_do(OH_OH_s_react_s_N, site)) then
        call del_proc(OH_OH_s_react_s_N, site)
    endif
    if (can_do(OH_OH_s_react_s_S, site)) then
        call del_proc(OH_OH_s_react_s_S, site)
    endif
    if (can_do(OH_OH_s_react_t, site)) then
        call del_proc(OH_OH_s_react_t, site)
    endif
    if (can_do(OH_OH_s_react_t_N, site)) then
        call del_proc(OH_OH_s_react_t_N, site)
    endif
    if (can_do(OH_OH_t_N_react_s, site)) then
        call del_proc(OH_OH_t_N_react_s, site)
    endif
    if (can_do(OH_OH_t_react_s, site)) then
        call del_proc(OH_OH_t_react_s, site)
    endif
    if (can_do(OH_OH_t_react_t_N, site)) then
        call del_proc(OH_OH_t_react_t_N, site)
    endif
    if (can_do(OH_OH_t_react_t_S, site)) then
        call del_proc(OH_OH_t_react_t_S, site)
    endif
    if (can_do(OH_diff_s_N_s, site)) then
        call del_proc(OH_diff_s_N_s, site)
    endif
    if (can_do(OH_diff_s_s_N, site)) then
        call del_proc(OH_diff_s_s_N, site)
    endif
    if (can_do(OH_diff_s_t, site)) then
        call del_proc(OH_diff_s_t, site)
    endif
    if (can_do(OH_diff_s_t_N, site)) then
        call del_proc(OH_diff_s_t_N, site)
    endif
    if (can_do(OH_diff_t_N_s, site)) then
        call del_proc(OH_diff_t_N_s, site)
    endif
    if (can_do(OH_diff_t_S_t, site)) then
        call del_proc(OH_diff_t_S_t, site)
    endif
    if (can_do(OH_diff_t_s, site)) then
        call del_proc(OH_diff_t_s, site)
    endif
    if (can_do(OH_diff_t_t_S, site)) then
        call del_proc(OH_diff_t_t_S, site)
    endif
    if (can_do(OH_s_dis, site)) then
        call del_proc(OH_s_dis, site)
    endif
    if (can_do(OH_t_dis, site)) then
        call del_proc(OH_t_dis, site)
    endif
    if (can_do(O_diff_s_N_s, site)) then
        call del_proc(O_diff_s_N_s, site)
    endif
    if (can_do(O_diff_s_s_N, site)) then
        call del_proc(O_diff_s_s_N, site)
    endif
    if (can_do(O_diff_s_t, site)) then
        call del_proc(O_diff_s_t, site)
    endif
    if (can_do(O_diff_s_t_N, site)) then
        call del_proc(O_diff_s_t_N, site)
    endif
    if (can_do(O_diff_t_N_s, site)) then
        call del_proc(O_diff_t_N_s, site)
    endif
    if (can_do(O_diff_t_S_t, site)) then
        call del_proc(O_diff_t_S_t, site)
    endif
    if (can_do(O_diff_t_s, site)) then
        call del_proc(O_diff_t_s, site)
    endif
    if (can_do(O_diff_t_t_S, site)) then
        call del_proc(O_diff_t_t_S, site)
    endif
    select case(get_species(site))
    case(empty)
        call add_proc(CH4_t_ads, site)
        call add_proc(CO_ads_t, site)
        call add_proc(H2O_t_ads, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(CH)
            call add_proc(CH_diff_t_t_S, site)
        case(C)
            call add_proc(C_diff_t_t_S, site)
        case(CH3)
            call add_proc(CH3_diff_t_t_S, site)
        case(O)
            call add_proc(H2O_O_t_react_t_S, site)
            call add_proc(O_diff_t_t_S, site)
        case(CH2)
            call add_proc(CH2_diff_t_t_S, site)
        case(CO)
            call add_proc(CO_diff_t_t_S, site)
        case(OH)
            call add_proc(OH_diff_t_t_S, site)
        end select

    case(CH)
        call add_proc(CH_t_dis, site)
        call add_proc(H_CH_t_react, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(CH_diff_t_S_t, site)
        end select

    case(CH3)
        call add_proc(CH3_t_dis, site)
        call add_proc(H_CH3_t_react, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(CH3_diff_t_S_t, site)
        end select

    case(C)
        call add_proc(H_C_t_react, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(C_diff_t_S_t, site)
        end select

    case(O)
        call add_proc(H_O_t_react, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(H2O_O_t_react_t_N, site)
            call add_proc(O_diff_t_S_t, site)
        end select

    case(CH2)
        call add_proc(CH2_t_dis, site)
        call add_proc(H_CH2_t_react, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(CH2_diff_t_S_t, site)
        end select

    case(CO)
        call add_proc(CO_des_t, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(CO_diff_t_S_t, site)
        end select

    case(OH)
        call add_proc(H_OH_t_react, site)
        call add_proc(OH_t_dis, site)
        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(OH_diff_t_S_t, site)
        case(OH)
            call add_proc(OH_OH_t_react_t_N, site)
            call add_proc(OH_OH_t_react_t_S, site)
        end select

    end select

end subroutine touchup_Rh211_t

subroutine touchup_Rh211_f(site)

    integer(kind=iint), dimension(4), intent(in) :: site

    if (can_do(CH2_diff_s_N_s, site)) then
        call del_proc(CH2_diff_s_N_s, site)
    endif
    if (can_do(CH2_diff_s_s_N, site)) then
        call del_proc(CH2_diff_s_s_N, site)
    endif
    if (can_do(CH2_diff_s_t, site)) then
        call del_proc(CH2_diff_s_t, site)
    endif
    if (can_do(CH2_diff_s_t_N, site)) then
        call del_proc(CH2_diff_s_t_N, site)
    endif
    if (can_do(CH2_diff_t_N_s, site)) then
        call del_proc(CH2_diff_t_N_s, site)
    endif
    if (can_do(CH2_diff_t_S_t, site)) then
        call del_proc(CH2_diff_t_S_t, site)
    endif
    if (can_do(CH2_diff_t_s, site)) then
        call del_proc(CH2_diff_t_s, site)
    endif
    if (can_do(CH2_diff_t_t_S, site)) then
        call del_proc(CH2_diff_t_t_S, site)
    endif
    if (can_do(CH2_s_E_dis_f, site)) then
        call del_proc(CH2_s_E_dis_f, site)
    endif
    if (can_do(CH2_s_dis, site)) then
        call del_proc(CH2_s_dis, site)
    endif
    if (can_do(CH2_t_N_dis_f, site)) then
        call del_proc(CH2_t_N_dis_f, site)
    endif
    if (can_do(CH2_t_dis, site)) then
        call del_proc(CH2_t_dis, site)
    endif
    if (can_do(CH2_t_dis_f, site)) then
        call del_proc(CH2_t_dis_f, site)
    endif
    if (can_do(CH3_diff_s_N_s, site)) then
        call del_proc(CH3_diff_s_N_s, site)
    endif
    if (can_do(CH3_diff_s_s_N, site)) then
        call del_proc(CH3_diff_s_s_N, site)
    endif
    if (can_do(CH3_diff_s_t, site)) then
        call del_proc(CH3_diff_s_t, site)
    endif
    if (can_do(CH3_diff_s_t_N, site)) then
        call del_proc(CH3_diff_s_t_N, site)
    endif
    if (can_do(CH3_diff_t_N_s, site)) then
        call del_proc(CH3_diff_t_N_s, site)
    endif
    if (can_do(CH3_diff_t_S_t, site)) then
        call del_proc(CH3_diff_t_S_t, site)
    endif
    if (can_do(CH3_diff_t_s, site)) then
        call del_proc(CH3_diff_t_s, site)
    endif
    if (can_do(CH3_diff_t_t_S, site)) then
        call del_proc(CH3_diff_t_t_S, site)
    endif
    if (can_do(CH3_s_dis, site)) then
        call del_proc(CH3_s_dis, site)
    endif
    if (can_do(CH3_t_dis, site)) then
        call del_proc(CH3_t_dis, site)
    endif
    if (can_do(CH4_s_ads, site)) then
        call del_proc(CH4_s_ads, site)
    endif
    if (can_do(CH4_t_ads, site)) then
        call del_proc(CH4_t_ads, site)
    endif
    if (can_do(CH_diff_f_S_f, site)) then
        call del_proc(CH_diff_f_S_f, site)
    endif
    if (can_do(CH_diff_f_f_S, site)) then
        call del_proc(CH_diff_f_f_S, site)
    endif
    if (can_do(CH_diff_f_s_E, site)) then
        call del_proc(CH_diff_f_s_E, site)
    endif
    if (can_do(CH_diff_f_t, site)) then
        call del_proc(CH_diff_f_t, site)
    endif
    if (can_do(CH_diff_f_t_N, site)) then
        call del_proc(CH_diff_f_t_N, site)
    endif
    if (can_do(CH_diff_s_E_f, site)) then
        call del_proc(CH_diff_s_E_f, site)
    endif
    if (can_do(CH_diff_s_N_s, site)) then
        call del_proc(CH_diff_s_N_s, site)
    endif
    if (can_do(CH_diff_s_s_N, site)) then
        call del_proc(CH_diff_s_s_N, site)
    endif
    if (can_do(CH_diff_s_t, site)) then
        call del_proc(CH_diff_s_t, site)
    endif
    if (can_do(CH_diff_s_t_N, site)) then
        call del_proc(CH_diff_s_t_N, site)
    endif
    if (can_do(CH_diff_t_N_f, site)) then
        call del_proc(CH_diff_t_N_f, site)
    endif
    if (can_do(CH_diff_t_N_s, site)) then
        call del_proc(CH_diff_t_N_s, site)
    endif
    if (can_do(CH_diff_t_S_t, site)) then
        call del_proc(CH_diff_t_S_t, site)
    endif
    if (can_do(CH_diff_t_f, site)) then
        call del_proc(CH_diff_t_f, site)
    endif
    if (can_do(CH_diff_t_s, site)) then
        call del_proc(CH_diff_t_s, site)
    endif
    if (can_do(CH_diff_t_t_S, site)) then
        call del_proc(CH_diff_t_t_S, site)
    endif
    if (can_do(CH_f_dis, site)) then
        call del_proc(CH_f_dis, site)
    endif
    if (can_do(CH_s_dis, site)) then
        call del_proc(CH_s_dis, site)
    endif
    if (can_do(CH_t_dis, site)) then
        call del_proc(CH_t_dis, site)
    endif
    if (can_do(CO_ads_s, site)) then
        call del_proc(CO_ads_s, site)
    endif
    if (can_do(CO_ads_t, site)) then
        call del_proc(CO_ads_t, site)
    endif
    if (can_do(CO_des_s, site)) then
        call del_proc(CO_des_s, site)
    endif
    if (can_do(CO_des_t, site)) then
        call del_proc(CO_des_t, site)
    endif
    if (can_do(CO_diff_s_N_s, site)) then
        call del_proc(CO_diff_s_N_s, site)
    endif
    if (can_do(CO_diff_s_s_N, site)) then
        call del_proc(CO_diff_s_s_N, site)
    endif
    if (can_do(CO_diff_s_t, site)) then
        call del_proc(CO_diff_s_t, site)
    endif
    if (can_do(CO_diff_s_t_N, site)) then
        call del_proc(CO_diff_s_t_N, site)
    endif
    if (can_do(CO_diff_t_N_s, site)) then
        call del_proc(CO_diff_t_N_s, site)
    endif
    if (can_do(CO_diff_t_S_t, site)) then
        call del_proc(CO_diff_t_S_t, site)
    endif
    if (can_do(CO_diff_t_s, site)) then
        call del_proc(CO_diff_t_s, site)
    endif
    if (can_do(CO_diff_t_t_S, site)) then
        call del_proc(CO_diff_t_t_S, site)
    endif
    if (can_do(C_OH_s_react_t_NW, site)) then
        call del_proc(C_OH_s_react_t_NW, site)
    endif
    if (can_do(C_OH_s_react_t_W, site)) then
        call del_proc(C_OH_s_react_t_W, site)
    endif
    if (can_do(C_OH_t_react_f, site)) then
        call del_proc(C_OH_t_react_f, site)
    endif
    if (can_do(C_OH_t_react_f_S, site)) then
        call del_proc(C_OH_t_react_f_S, site)
    endif
    if (can_do(C_diff_f_S_f, site)) then
        call del_proc(C_diff_f_S_f, site)
    endif
    if (can_do(C_diff_f_f_S, site)) then
        call del_proc(C_diff_f_f_S, site)
    endif
    if (can_do(C_diff_f_s_E, site)) then
        call del_proc(C_diff_f_s_E, site)
    endif
    if (can_do(C_diff_f_t, site)) then
        call del_proc(C_diff_f_t, site)
    endif
    if (can_do(C_diff_f_t_N, site)) then
        call del_proc(C_diff_f_t_N, site)
    endif
    if (can_do(C_diff_s_E_f, site)) then
        call del_proc(C_diff_s_E_f, site)
    endif
    if (can_do(C_diff_s_N_s, site)) then
        call del_proc(C_diff_s_N_s, site)
    endif
    if (can_do(C_diff_s_s_N, site)) then
        call del_proc(C_diff_s_s_N, site)
    endif
    if (can_do(C_diff_s_t, site)) then
        call del_proc(C_diff_s_t, site)
    endif
    if (can_do(C_diff_s_t_N, site)) then
        call del_proc(C_diff_s_t_N, site)
    endif
    if (can_do(C_diff_t_N_f, site)) then
        call del_proc(C_diff_t_N_f, site)
    endif
    if (can_do(C_diff_t_N_s, site)) then
        call del_proc(C_diff_t_N_s, site)
    endif
    if (can_do(C_diff_t_S_t, site)) then
        call del_proc(C_diff_t_S_t, site)
    endif
    if (can_do(C_diff_t_f, site)) then
        call del_proc(C_diff_t_f, site)
    endif
    if (can_do(C_diff_t_s, site)) then
        call del_proc(C_diff_t_s, site)
    endif
    if (can_do(C_diff_t_t_S, site)) then
        call del_proc(C_diff_t_t_S, site)
    endif
    if (can_do(H2O_O_s_react_s_N, site)) then
        call del_proc(H2O_O_s_react_s_N, site)
    endif
    if (can_do(H2O_O_s_react_s_S, site)) then
        call del_proc(H2O_O_s_react_s_S, site)
    endif
    if (can_do(H2O_O_s_react_t, site)) then
        call del_proc(H2O_O_s_react_t, site)
    endif
    if (can_do(H2O_O_s_react_t_N, site)) then
        call del_proc(H2O_O_s_react_t_N, site)
    endif
    if (can_do(H2O_O_t_N_react_s, site)) then
        call del_proc(H2O_O_t_N_react_s, site)
    endif
    if (can_do(H2O_O_t_react_s, site)) then
        call del_proc(H2O_O_t_react_s, site)
    endif
    if (can_do(H2O_O_t_react_t_N, site)) then
        call del_proc(H2O_O_t_react_t_N, site)
    endif
    if (can_do(H2O_O_t_react_t_S, site)) then
        call del_proc(H2O_O_t_react_t_S, site)
    endif
    if (can_do(H2O_s_ads, site)) then
        call del_proc(H2O_s_ads, site)
    endif
    if (can_do(H2O_t_ads, site)) then
        call del_proc(H2O_t_ads, site)
    endif
    if (can_do(H_CH2_s_react, site)) then
        call del_proc(H_CH2_s_react, site)
    endif
    if (can_do(H_CH2_t_react, site)) then
        call del_proc(H_CH2_t_react, site)
    endif
    if (can_do(H_CH3_s_react, site)) then
        call del_proc(H_CH3_s_react, site)
    endif
    if (can_do(H_CH3_t_react, site)) then
        call del_proc(H_CH3_t_react, site)
    endif
    if (can_do(H_CH_f_react_s_E, site)) then
        call del_proc(H_CH_f_react_s_E, site)
    endif
    if (can_do(H_CH_f_react_t, site)) then
        call del_proc(H_CH_f_react_t, site)
    endif
    if (can_do(H_CH_f_react_t_N, site)) then
        call del_proc(H_CH_f_react_t_N, site)
    endif
    if (can_do(H_CH_s_react, site)) then
        call del_proc(H_CH_s_react, site)
    endif
    if (can_do(H_CH_t_react, site)) then
        call del_proc(H_CH_t_react, site)
    endif
    if (can_do(H_CO_s_react_t_NW, site)) then
        call del_proc(H_CO_s_react_t_NW, site)
    endif
    if (can_do(H_CO_s_react_t_W, site)) then
        call del_proc(H_CO_s_react_t_W, site)
    endif
    if (can_do(H_CO_t_react_f, site)) then
        call del_proc(H_CO_t_react_f, site)
    endif
    if (can_do(H_CO_t_react_f_S, site)) then
        call del_proc(H_CO_t_react_f_S, site)
    endif
    if (can_do(H_C_f_react, site)) then
        call del_proc(H_C_f_react, site)
    endif
    if (can_do(H_C_s_react, site)) then
        call del_proc(H_C_s_react, site)
    endif
    if (can_do(H_C_t_react, site)) then
        call del_proc(H_C_t_react, site)
    endif
    if (can_do(H_OH_s_react, site)) then
        call del_proc(H_OH_s_react, site)
    endif
    if (can_do(H_OH_t_react, site)) then
        call del_proc(H_OH_t_react, site)
    endif
    if (can_do(H_O_s_react, site)) then
        call del_proc(H_O_s_react, site)
    endif
    if (can_do(H_O_t_react, site)) then
        call del_proc(H_O_t_react, site)
    endif
    if (can_do(OH_OH_s_react_s_N, site)) then
        call del_proc(OH_OH_s_react_s_N, site)
    endif
    if (can_do(OH_OH_s_react_s_S, site)) then
        call del_proc(OH_OH_s_react_s_S, site)
    endif
    if (can_do(OH_OH_s_react_t, site)) then
        call del_proc(OH_OH_s_react_t, site)
    endif
    if (can_do(OH_OH_s_react_t_N, site)) then
        call del_proc(OH_OH_s_react_t_N, site)
    endif
    if (can_do(OH_OH_t_N_react_s, site)) then
        call del_proc(OH_OH_t_N_react_s, site)
    endif
    if (can_do(OH_OH_t_react_s, site)) then
        call del_proc(OH_OH_t_react_s, site)
    endif
    if (can_do(OH_OH_t_react_t_N, site)) then
        call del_proc(OH_OH_t_react_t_N, site)
    endif
    if (can_do(OH_OH_t_react_t_S, site)) then
        call del_proc(OH_OH_t_react_t_S, site)
    endif
    if (can_do(OH_diff_s_N_s, site)) then
        call del_proc(OH_diff_s_N_s, site)
    endif
    if (can_do(OH_diff_s_s_N, site)) then
        call del_proc(OH_diff_s_s_N, site)
    endif
    if (can_do(OH_diff_s_t, site)) then
        call del_proc(OH_diff_s_t, site)
    endif
    if (can_do(OH_diff_s_t_N, site)) then
        call del_proc(OH_diff_s_t_N, site)
    endif
    if (can_do(OH_diff_t_N_s, site)) then
        call del_proc(OH_diff_t_N_s, site)
    endif
    if (can_do(OH_diff_t_S_t, site)) then
        call del_proc(OH_diff_t_S_t, site)
    endif
    if (can_do(OH_diff_t_s, site)) then
        call del_proc(OH_diff_t_s, site)
    endif
    if (can_do(OH_diff_t_t_S, site)) then
        call del_proc(OH_diff_t_t_S, site)
    endif
    if (can_do(OH_s_dis, site)) then
        call del_proc(OH_s_dis, site)
    endif
    if (can_do(OH_t_dis, site)) then
        call del_proc(OH_t_dis, site)
    endif
    if (can_do(O_diff_s_N_s, site)) then
        call del_proc(O_diff_s_N_s, site)
    endif
    if (can_do(O_diff_s_s_N, site)) then
        call del_proc(O_diff_s_s_N, site)
    endif
    if (can_do(O_diff_s_t, site)) then
        call del_proc(O_diff_s_t, site)
    endif
    if (can_do(O_diff_s_t_N, site)) then
        call del_proc(O_diff_s_t_N, site)
    endif
    if (can_do(O_diff_t_N_s, site)) then
        call del_proc(O_diff_t_N_s, site)
    endif
    if (can_do(O_diff_t_S_t, site)) then
        call del_proc(O_diff_t_S_t, site)
    endif
    if (can_do(O_diff_t_s, site)) then
        call del_proc(O_diff_t_s, site)
    endif
    if (can_do(O_diff_t_t_S, site)) then
        call del_proc(O_diff_t_t_S, site)
    endif
    select case(get_species(site))
    case(C)
        call add_proc(H_C_f_react, site)
        select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_f/)))
        case(empty)
            call add_proc(C_diff_f_s_E, site)
            select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
            case(OH)
                call add_proc(C_OH_s_react_t_NW, site)
            end select

            select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
            case(OH)
                call add_proc(C_OH_s_react_t_W, site)
            end select

        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(C_diff_f_t, site)
        case(OH)
            call add_proc(C_OH_t_react_f, site)
        end select

        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(C_diff_f_t_N, site)
        case(OH)
            call add_proc(C_OH_t_react_f_S, site)
        end select

        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(C_diff_f_S_f, site)
        end select

    case(empty)
        select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_f/)))
        case(C)
            call add_proc(C_diff_s_E_f, site)
        case(CH2)
            call add_proc(CH2_s_E_dis_f, site)
        case(CO)
            select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
            case(empty)
                call add_proc(H_CO_s_react_t_NW, site)
            end select

            select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
            case(empty)
                call add_proc(H_CO_s_react_t_W, site)
            end select

        case(CH)
            call add_proc(CH_diff_s_E_f, site)
        end select

        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
        case(C)
            call add_proc(C_diff_t_N_f, site)
        case(CH2)
            call add_proc(CH2_t_N_dis_f, site)
        case(CO)
            call add_proc(H_CO_t_react_f_S, site)
        case(CH)
            call add_proc(CH_diff_t_N_f, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
        case(C)
            call add_proc(C_diff_t_f, site)
        case(CH2)
            call add_proc(CH2_t_dis_f, site)
        case(CO)
            call add_proc(H_CO_t_react_f, site)
        case(CH)
            call add_proc(CH_diff_t_f, site)
        end select

        select case(get_species(site + (/0, 1, 0, 0/)))
        case(C)
            call add_proc(C_diff_f_f_S, site)
        case(CH)
            call add_proc(CH_diff_f_f_S, site)
        end select

    case(CH)
        call add_proc(CH_f_dis, site)
        select case(get_species(site + (/1, 0, 0, Rh211_s - Rh211_f/)))
        case(empty)
            call add_proc(CH_diff_f_s_E, site)
            call add_proc(H_CH_f_react_s_E, site)
        end select

        select case(get_species(site + (/0, 0, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(CH_diff_f_t, site)
            call add_proc(H_CH_f_react_t, site)
        end select

        select case(get_species(site + (/0, 1, 0, Rh211_t - Rh211_f/)))
        case(empty)
            call add_proc(CH_diff_f_t_N, site)
            call add_proc(H_CH_f_react_t_N, site)
        end select

        select case(get_species(site + (/0, 1, 0, 0/)))
        case(empty)
            call add_proc(CH_diff_f_S_f, site)
        end select

    end select

end subroutine touchup_Rh211_f

end module proclist
